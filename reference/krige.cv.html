<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Cross validation functions for simple, ordinary or universal
point (co)kriging, kriging in a local neighbourhood."><title>(co)kriging cross validation, n-fold or leave-one-out — krige.cv • gstat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="(co)kriging cross validation, n-fold or leave-one-out — krige.cv"><meta property="og:description" content="Cross validation functions for simple, ordinary or universal
point (co)kriging, kriging in a local neighbourhood."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gstat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1-2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-spatial/gstat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>(co)kriging cross validation, n-fold or leave-one-out</h1>
      
      <div class="d-none name"><code>krige.cv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Cross validation functions for simple, ordinary or universal
point (co)kriging, kriging in a local neighbourhood.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gstat.cv</span><span class="op">(</span><span class="va">object</span>, <span class="va">nfold</span>, remove.all <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>  all.residuals <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">krige.cv</span><span class="op">(</span><span class="va">formula</span>, <span class="va">locations</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">krige.cv.locations</span><span class="op">(</span><span class="va">formula</span>, <span class="va">locations</span>, <span class="va">data</span>, model <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span>, beta <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  nmax <span class="op">=</span> <span class="cn">Inf</span>, nmin <span class="op">=</span> <span class="fl">0</span>, maxdist <span class="op">=</span> <span class="cn">Inf</span>, nfold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, </span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>, debug.level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu">krige.cv.spatial</span><span class="op">(</span><span class="va">formula</span>, <span class="va">locations</span>, model <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span>, beta <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  nmax <span class="op">=</span> <span class="cn">Inf</span>, nmin <span class="op">=</span> <span class="fl">0</span>, maxdist <span class="op">=</span> <span class="cn">Inf</span>, nfold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">locations</span><span class="op">)</span>, </span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>, debug.level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>object of class gstat; see function <a href="gstat.html">gstat</a></p></dd>

  <dt>nfold</dt>
<dd><p>integer; if larger than 1, then apply n-fold cross validation; 
  if <code>nfold</code> equals <code>nrow(data)</code> (the default), apply leave-one-out cross 
  validation; if set to e.g. 5, five-fold cross validation is done. To specify the
  folds, pass an integer vector of length <code>nrow(data)</code> with fold indexes.</p></dd>

  <dt>remove.all</dt>
<dd><p>logical; if TRUE, remove observations at cross validation
  locations not only for the first, but for all subsequent variables as well</p></dd>

  <dt>verbose</dt>
<dd><p>logical; if FALSE, progress bar is suppressed</p></dd>

  <dt>all.residuals</dt>
<dd><p>logical; if TRUE, residuals for all variables are
  returned instead of for the first variable only</p></dd>

  <dt>...</dt>
<dd><p>other arguments that will be passed to <a href="predict.gstat.html">predict</a>
  in case of <code>gstat.cv</code>, or to <a href="gstat.html">gstat</a> in case of <code>krige.cv</code></p></dd>

  <dt>formula</dt>
<dd><p>formula that defines the dependent variable as a linear
  model of independent variables; suppose the dependent variable has name
  <code>z</code>, for ordinary and simple kriging use the formula <code>z~1</code>;
  for simple kriging also define <code>beta</code> (see below); for universal
  kriging, suppose <code>z</code> is linearly dependent on <code>x</code> and <code>y</code>,
  use the formula <code>z~x+y</code></p></dd>

  <dt>locations</dt>
<dd><p>data object deriving from class <code>Spatial</code> or <code>sf</code></p></dd>

  <dt>data</dt>
<dd><p>data frame (deprecated); should contain the dependent variable, independent
  variables, and coordinates; only to be provided if <code>locations</code> is a formula</p></dd>

  <dt>model</dt>
<dd><p>variogram model of dependent variable (or its residuals), 
  defined by a call to <a href="vgm.html">vgm</a> or <a href="fit.variogram.html">fit.variogram</a></p></dd>

  <dt>beta</dt>
<dd><p>only for simple kriging (and simulation based on simple
  kriging); vector with the trend coefficients (including intercept);
  if no independent variables are defined the model only contains an
  intercept and this should be the simple kriging mean</p></dd>

  <dt>nmax</dt>
<dd><p>for local kriging: the number of nearest observations that
  should be used for a kriging prediction or simulation, where nearest
  is defined in terms of the space of the spatial locations. By default,
  all observations are used</p></dd>

  <dt>nmin</dt>
<dd><p>for local kriging: if the number of nearest observations
  within distance <code>maxdist</code> is less than <code>nmin</code>, a missing 
  value will be generated; see maxdist</p></dd>

  <dt>maxdist</dt>
<dd><p>for local kriging: only observations within a distance
  of <code>maxdist</code> from the prediction location are used for prediction
  or simulation; if combined with <code>nmax</code>, both criteria apply</p></dd>

  <dt>debug.level</dt>
<dd><p>print debugging information; 0 suppresses
  debug information</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    
<dl><dt>formula = "formula", locations = "formula"</dt>
<dd><p>locations specifies which coordinates in <code>data</code> refer to spatial coordinates</p></dd>

<dt>formula = "formula", locations = "Spatial"</dt>
<dd><p>Object locations knows about its own spatial locations</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Leave-one-out cross validation (LOOCV) visits a data point, and
predicts the value at that location by leaving out the observed value,
and proceeds with the next data point. (The observed value is left
out because kriging would otherwise predict the value itself.) N-fold
cross validation makes a partitions the data set in N parts. For all
observation in a part, predictions are made based on the remaining N-1
parts; this is repeated for each of the N parts. N-fold cross validation
may be faster than LOOCV.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>data frame containing the coordinates of <code>data</code> or those
of the first variable in <code>object</code>, and columns of prediction and
prediction variance of cross validated data points, observed values,
residuals, zscore (residual divided by kriging standard error), and fold.</p>


<p>If <code>all.residuals</code> is true, a data frame with residuals for all
variables is returned, without coordinates.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><a href="http://www.gstat.org/" class="external-link">http://www.gstat.org/</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Edzer Pebesma</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Leave-one-out cross validation seems to be much faster in plain
(stand-alone) gstat, apparently quite a bit of the effort is spent moving 
data around from R to gstat.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="krige.html">krige</a>, <a href="gstat.html">gstat</a>, <a href="predict.gstat.html">predict</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="vgm.html">vgm</a></span><span class="op">(</span><span class="fl">.59</span>, <span class="st">"Sph"</span>, <span class="fl">874</span>, <span class="fl">.04</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># five-fold cross validation:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">krige.cv</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, <span class="va">m</span>, nmax <span class="op">=</span> <span class="fl">40</span>, nfold<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/bubble.html" class="external-link">bubble</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"residual"</span>, main <span class="op">=</span> <span class="st">"log(zinc): 5-fold CV residuals"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="krige.cv-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># multivariable; thanks to M. Rufino:</span></span></span>
<span class="r-in"><span><span class="va">meuse.g</span> <span class="op">&lt;-</span> <span class="fu"><a href="gstat.html">gstat</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"zn"</span>, formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">meuse.g</span> <span class="op">&lt;-</span> <span class="fu"><a href="gstat.html">gstat</a></span><span class="op">(</span><span class="va">meuse.g</span>, <span class="st">"cu"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">copper</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">meuse.g</span> <span class="op">&lt;-</span> <span class="fu"><a href="gstat.html">gstat</a></span><span class="op">(</span><span class="va">meuse.g</span>, model <span class="op">=</span> <span class="fu"><a href="vgm.html">vgm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Sph"</span>, <span class="fl">900</span>, <span class="fl">1</span><span class="op">)</span>, fill.all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="variogram.html">variogram</a></span><span class="op">(</span><span class="va">meuse.g</span>, cutoff <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">meuse.fit</span> <span class="op">=</span> <span class="fu"><a href="fit.lmc.html">fit.lmc</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">meuse.g</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">gstat.cv</span><span class="op">(</span><span class="va">meuse.fit</span>, nmax <span class="op">=</span> <span class="fl">40</span>, nfold <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear Model of Coregionalization found. Good.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary cokriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear Model of Coregionalization found. Good.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary cokriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear Model of Coregionalization found. Good.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary cokriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear Model of Coregionalization found. Good.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary cokriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear Model of Coregionalization found. Good.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary cokriging]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class SpatialPointsDataFrame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      min    max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x 178605 181390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y 329714 333611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Is projected: NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> proj4string : [NA]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of points: 155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data attributes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     zn.pred          zn.var           observed        residual        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   :4.660   Min.   :0.04106   Min.   :4.727   Min.   :-1.046096  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.:5.314   1st Qu.:0.05054   1st Qu.:5.288   1st Qu.:-0.133537  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median :5.775   Median :0.05452   Median :5.787   Median : 0.006930  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   :5.882   Mean   :0.05632   Mean   :5.886   Mean   : 0.003514  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.:6.403   3rd Qu.:0.06034   3rd Qu.:6.514   3rd Qu.: 0.160171  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :7.687   Max.   :0.09869   Max.   :7.517   Max.   : 0.518525  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      zscore              fold      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   :-4.22112   Min.   :1.000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.:-0.53431   1st Qu.:2.000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 0.03024   Median :3.000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 0.01530   Mean   :2.942  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.: 0.67320   3rd Qu.:4.000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   : 2.45696   Max.   :5.000  </span>
<span class="r-in"><span><span class="va">out</span> <span class="op">=</span> <span class="fu">gstat.cv</span><span class="op">(</span><span class="va">meuse.fit</span>, nmax <span class="op">=</span> <span class="fl">40</span>, nfold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">55</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear Model of Coregionalization found. Good.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary cokriging]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Linear Model of Coregionalization found. Good.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary cokriging]</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class SpatialPointsDataFrame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      min    max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x 178605 181390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y 329714 333611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Is projected: NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> proj4string : [NA]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of points: 155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data attributes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     zn.pred          zn.var           observed        residual       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   :4.856   Min.   :0.04393   Min.   :4.727   Min.   :-1.52437  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.:5.382   1st Qu.:0.05944   1st Qu.:5.288   1st Qu.:-0.27045  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median :5.903   Median :0.07107   Median :5.787   Median :-0.09095  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   :5.966   Mean   :0.07283   Mean   :5.886   Mean   :-0.07990  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.:6.428   3rd Qu.:0.08454   3rd Qu.:6.514   3rd Qu.: 0.14914  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :7.734   Max.   :0.10621   Max.   :7.517   Max.   : 0.55106  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      zscore             fold      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   :-4.7612   Min.   :1.000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.:-0.9359   1st Qu.:1.000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median :-0.3354   Median :1.000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   :-0.2678   Mean   :1.355  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.: 0.6001   3rd Qu.:2.000  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   : 2.3860   Max.   :2.000  </span>
<span class="r-in"><span><span class="co"># mean error, ideally 0:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">residual</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.07990434</span>
<span class="r-in"><span><span class="co"># MSPE, ideally small</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">residual</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1101475</span>
<span class="r-in"><span><span class="co"># Mean square normalized error, ideally close to 1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">zscore</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.487834</span>
<span class="r-in"><span><span class="co"># correlation observed and predicted, ideally 1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">observed</span>, <span class="va">out</span><span class="op">$</span><span class="va">observed</span> <span class="op">-</span> <span class="va">out</span><span class="op">$</span><span class="va">residual</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8955611</span>
<span class="r-in"><span><span class="co"># correlation predicted and residual, ideally 0</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">observed</span> <span class="op">-</span> <span class="va">out</span><span class="op">$</span><span class="va">residual</span>, <span class="va">out</span><span class="op">$</span><span class="va">residual</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.1103516</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edzer Pebesma, Benedikt Graeler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

