<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates the sample variogram from spatio-temporal data."><title>Calculate Spatio-Temporal Sample Variogram — variogramST • gstat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Spatio-Temporal Sample Variogram — variogramST"><meta property="og:description" content="Calculates the sample variogram from spatio-temporal data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gstat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1-2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-spatial/gstat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate Spatio-Temporal Sample Variogram</h1>
      
      <div class="d-none name"><code>variogramST.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the sample variogram from spatio-temporal data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">variogramST</span><span class="op">(</span><span class="va">formula</span>, <span class="va">locations</span>, <span class="va">data</span>, <span class="va">...</span>, tlags <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">15</span>,  <span class="va">cutoff</span>,</span>
<span>  width <span class="op">=</span> <span class="va">cutoff</span><span class="op">/</span><span class="fl">15</span>, boundaries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">cutoff</span>, <span class="va">width</span><span class="op">)</span>,</span>
<span>  progress <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>, pseudo <span class="op">=</span> <span class="cn">TRUE</span>, assumeRegular <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  na.omit <span class="op">=</span> <span class="cn">FALSE</span>, cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>formula, specifying the dependent variable.</p></dd>

<dt>locations</dt>
<dd><p>A STFDF or STSDF containing the variable; kept for 
  compatibility reasons with variogram, either <code>locations</code> or <code>data</code> 
  must be provided.</p></dd>

<dt>data</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/spacetime/man/STFDF-class.html" class="external-link">STFDF</a></code>, <code><a href="https://rdrr.io/pkg/spacetime/man/STSDF-class.html" class="external-link">STSDF</a></code> or <code><a href="https://rdrr.io/pkg/spacetime/man/STIDF-class.html" class="external-link">STIDF</a></code> containing the variable.</p></dd>

<dt>...</dt>
<dd><p>any other arguments that will be passed to the underlying 
  <code><a href="variogram.html">variogram</a></code> function. In case of using data of type <code><a href="https://rdrr.io/pkg/spacetime/man/STIDF-class.html" class="external-link">STIDF</a></code>, the argument <code>tunit</code> is recommended (and only used in the case of STIDF) to set the temporal unit of the <code>tlags</code>. Additionally, <code>twindow</code> can be passed to control the temporal window used for temporal distance calculations. This builds on the property of xts being ordered and only the next <code>twindow</code> instances are considered. This avoids the need of huge temporal distance matrices. The default uses twice the number as the average difference goes into the temporal cutoff.</p></dd>

<dt>tlags</dt>
<dd><p>integer; time lags to consider or in case <code>data</code> is of class <code><a href="https://rdrr.io/pkg/spacetime/man/STIDF-class.html" class="external-link">STIDF</a></code> the actual temporal boundaries with time unit given by <code>tunit</code> otherwise the same unit as <code><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></code> on the index of the time slot will generate is assumed.</p></dd>

<dt>cutoff</dt>
<dd><p>spatial separation distance up to which point pairs
are included in semivariance estimates; as a default, the
length of the diagonal of the box spanning the data is divided by three.</p></dd>

<dt>width</dt>
<dd><p>the width of subsequent distance intervals into which
data point pairs are grouped for semivariance estimates, by default the 
  <code>cutoff</code> is divided into 15 equal lags.</p></dd>

<dt>boundaries</dt>
<dd><p>numerical vector with distance interval upper boundaries; 
values should be strictly increasing</p></dd>

<dt>progress</dt>
<dd><p>logical; if TRUE, show text progress bar</p></dd>

<dt>pseudo</dt>
<dd><p>integer; use pseudo cross variogram for computing
time-lagged spatial variograms? -1: find out from coordinates -- if they
are equal then yes, else no; 0: no; 1: yes.</p></dd>

<dt>assumeRegular</dt>
<dd><p>logical; whether the time series should be assumed regular. 
  The first time step is assumed to be representative for the whole series. Note,
  that temporal lags are considered by index, and no check is made whether pairs
  actually have the desired separating distance.</p></dd>

<dt>na.omit</dt>
<dd><p>shall all <code>NA</code> values in the spatio-temporal variogram be dropped? In case where complete rows or columns in the variogram consists of <code>NA</code> only, <code>plot</code> might produce a distorted picture.</p></dd>

<dt>cores</dt>
<dd><p>number of cores to use in parallel</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The spatio-temporal sample variogram contains besides the fields</p>
<p></p>
<p><code>np</code>, <code>dist</code> and <code>gamma</code> the spatio-temporal fields,</p>
<p></p>
<p><code>timelag</code>, <code>spacelag</code> and <code>avgDist</code>, the first of which indicates the time lag 
  used, the second and third different spatial lags. <code>spacelag</code> is the midpoint in the spatial
  lag intervals as passed by the parameter <code>boundaries</code>, whereas <code>avgDist</code> is the average 
  distance between the point pairs found in a distance interval over all temporal lags (i.e. the 
  averages of the values <code>dist</code> per temporal lag.) To compute variograms for space lag \(h\) and
  time lag \(t\), the pseudo cross variogram \((Z_i(s)-Z_{i+t}(s+h))^2\) is averaged over all time 
  lagged observation sets \(Z_i\) and \(Z_{i+t}\) available (weighted by the number of pairs involved).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cressie, N.A.C., 1993, Statistics for Spatial Data, Wiley.</p>
<p>Cressie, N., C. Wikle, 2011, Statistics for Spatio-temporal Data, Wiley.</p>
<p><a href="http://www.gstat.org/" class="external-link">http://www.gstat.org/</a></p>
<p>Pebesma, E.J., 2004. Multivariable geostatistics in S: the gstat package.
Computers and Geosciences, 30: 683-691.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Edzer Pebesma, Benedikt Graeler</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.gstatVariogram.html">plot.StVariogram</a></code>,
for variogram models: <code><a href="vgmST.html">vgmST</a></code>,
to fit a spatio-temporal variogram model to a spatio-temporal sample variogram: 
<code><a href="fit.StVariogram.html">fit.StVariogram</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># The following spatio-temporal variogram has been calcualted through</span></span></span>
<span class="r-in"><span><span class="co"># vv = variogram(PM10~1, r5to10, width=20, cutoff = 200, tlags=0:5)</span></span></span>
<span class="r-in"><span><span class="co"># in the vignette "st".</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">vv</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Classes ‘StVariogram’ and 'data.frame':	66 obs. of  7 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ np      : num  0 3456 16554 21257 33547 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dist    : num  NA 13.8 29.5 49.1 70.4 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ gamma   : num  NA 11 23.4 29.6 31.2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ id      : chr  "lag0" "lag0" "lag0" "lag0" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ timelag : num  0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "units")= chr "days"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ spacelag: num  0 10 30 50 70 90 110 130 150 170 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "units")= chr "km"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ avgDist : num  0 13.8 29.5 49.1 70.4 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - attr(*, "boundaries")= num [1:11] 0 20 40 60 80 100 120 140 160 180 ...</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vv</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="variogramST-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edzer Pebesma, Benedikt Graeler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

