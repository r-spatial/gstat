<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function that creates gstat objects; objects that hold all the information
necessary for univariate or multivariate geostatistical prediction
(simple, ordinary or universal (co)kriging), or its conditional or
unconditional Gaussian or indicator simulation equivalents. Multivariate
gstat object can be subsetted."><title>Create gstat objects, or subset it — gstat • gstat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create gstat objects, or subset it — gstat"><meta property="og:description" content="Function that creates gstat objects; objects that hold all the information
necessary for univariate or multivariate geostatistical prediction
(simple, ordinary or universal (co)kriging), or its conditional or
unconditional Gaussian or indicator simulation equivalents. Multivariate
gstat object can be subsetted."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gstat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1-2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-spatial/gstat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create gstat objects, or subset it</h1>
      
      <div class="d-none name"><code>gstat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function that creates gstat objects; objects that hold all the information
necessary for univariate or multivariate geostatistical prediction
(simple, ordinary or universal (co)kriging), or its conditional or
unconditional Gaussian or indicator simulation equivalents. Multivariate
gstat object can be subsetted.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gstat</span><span class="op">(</span><span class="va">g</span>, <span class="va">id</span>, <span class="va">formula</span>, <span class="va">locations</span>, <span class="va">data</span>, model <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">beta</span>,</span>
<span>  nmax <span class="op">=</span> <span class="cn">Inf</span>, nmin <span class="op">=</span> <span class="fl">0</span>, omax <span class="op">=</span> <span class="fl">0</span>, maxdist <span class="op">=</span> <span class="cn">Inf</span>, force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dummy <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">set</span>, fill.all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fill.cross <span class="op">=</span> <span class="cn">TRUE</span>, variance <span class="op">=</span> <span class="st">"identity"</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">merge</span>, </span>
<span>  degree <span class="op">=</span> <span class="fl">0</span>, vdist <span class="op">=</span> <span class="cn">FALSE</span>, lambda <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="co"># S3 method for gstat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>g</dt>
<dd><p>gstat object to append to; if missing, a new gstat object
  is created</p></dd>

  <dt>id</dt>
<dd><p>identifier of new variable; if missing, <code>varn</code> is used with
    <code>n</code> the number for this variable. If a cross variogram is entered,
    <code>id</code> should be a vector with the two <code>id</code> values , e.g. 
    <code>c("zn", "cd")</code>, further only supplying arguments <code>g</code> 
    and <code>model</code>. It is advisable not to use expressions, such
	as <code>log(zinc)</code>, as identifiers, as this may lead to complications 
	later on.</p></dd>

  <dt>formula</dt>
<dd><p>formula that defines the dependent variable as a linear
  model of independent variables; suppose the dependent variable has name
  <code>z</code>, for ordinary and simple kriging use the formula <code>z~1</code>;
  for simple kriging also define <code>beta</code> (see below); for universal
  kriging, suppose <code>z</code> is linearly dependent on <code>x</code> and <code>y</code>,
  use the formula <code>z~x+y</code></p></dd>

  <dt>locations</dt>
<dd><p>formula with only independent variables that define the
  spatial data locations (coordinates), e.g. <code>~x+y</code>; if <code>data</code>
  has a <code>coordinates</code> method to extract its coordinates this argument 
  can be ignored (see package sp for classes for point or grid data).</p></dd>

  <dt>data</dt>
<dd><p>data frame; contains the dependent variable, independent
  variables, and locations.</p></dd>

  <dt>model</dt>
<dd><p>variogram model for this <code>id</code>; defined by a call to 
  <a href="vgm.html">vgm</a>; see argument <code>id</code> to see how cross variograms are entered</p></dd>

  <dt>beta</dt>
<dd><p>for simple kriging (and simulation based on simple
  kriging): vector with the trend coefficients (including intercept);
  if no independent variables are defined the model only contains an
  intercept and this should be the expected value; for cross 
  variogram computations: mean parameters to be used instead of the 
  OLS estimates</p></dd>

  <dt>nmax</dt>
<dd><p>for local kriging: the number of nearest observations that
  should be used for a kriging prediction or simulation, where nearest
  is defined in terms of the space of the spatial locations</p></dd>

  <dt>nmin</dt>
<dd><p>for local kriging: if the number of nearest observations
  within distance <code>maxdist</code> is less than <code>nmin</code>, a missing 
  value will be generated, unless <code>force==TRUE</code>; see <code>maxdist</code></p></dd>

  <dt>omax</dt>
<dd><p>maximum number of observations to select per octant (3D) or
  quadrant (2D); only relevant if <code>maxdist</code> has been defined as well</p></dd>

  <dt>maxdist</dt>
<dd><p>for local kriging: only observations within a distance
  of <code>maxdist</code> from the prediction location are used for prediction
  or simulation; if combined with <code>nmax</code>, both criteria apply</p></dd>

  <dt>force</dt>
<dd><p>for local kriging, force neighbourhood selection: in case
  <code>nmin</code> is given, search beyond <code>maxdist</code> until <code>nmin</code>
  neighbours are found. A missing value is returned if this is not possible.</p></dd>

  <dt>dummy</dt>
<dd><p>logical; if TRUE, consider this data as a dummy variable
  (only necessary for unconditional simulation)</p></dd>

  <dt>set</dt>
<dd><p>named list with optional parameters to be passed to
  gstat (only <code>set</code> commands of gstat are allowed, and not all of
  them may be relevant; see the manual for gstat stand-alone, URL below )</p></dd>

  <dt>x</dt>
<dd><p>gstat object to print</p></dd>

  <dt>fill.all</dt>
<dd><p>logical; if TRUE, fill all of the direct variogram and,
  depending on the value of <code>fill.cross</code> also all cross
  variogram model slots in <code>g</code> with the given variogram model</p></dd>

  <dt>fill.cross</dt>
<dd><p>logical; if TRUE, fill all of the cross variograms, if
  FALSE fill only all direct variogram model slots in <code>g</code> with the 
  given variogram model (only if <code>fill.all</code> is used)</p></dd>

  <dt>variance</dt>
<dd><p>character; variance function to transform to non-stationary
  covariances; "identity" does not transform, other options are "mu" (Poisson)
  and "mu(1-mu)" (binomial)</p></dd>

  <dt>weights</dt>
<dd><p>numeric vector; if present, covariates are present,
  and variograms are missing weights are passed to OLS prediction routines
  resulting in WLS; if variograms are given, weights should be 1/variance, 
  where variance specifies location-specific measurement error; see references 
  section below</p></dd>

  <dt>merge</dt>
<dd><p>either character vector of length 2, indicating two ids 
  that share a common mean; the more general gstat merging of any two
  coefficients across variables is obtained when a list is passed, with
  each element a character vector of length 4, in the form 
  <code>c("id1", 1,"id2", 2)</code>. This merges the first parameter 
  for variable <code>id1</code> to the second of variable <code>id2</code>.</p></dd>

  <dt>degree</dt>
<dd><p>order of trend surface in the location, between 0 and 3</p></dd>

  <dt>vdist</dt>
<dd><p>logical; if TRUE, instead of Euclidian distance 
  variogram distance is used for selecting the nmax nearest neighbours,
  after observations within distance maxdist (Euclidian/geographic) have been 
  pre-selected</p></dd>

  <dt>lambda</dt>
<dd><p>test feature; doesn't do anything (yet)</p></dd>

  <dt>...</dt>
<dd><p>arguments that are passed to the printing of variogram
  models only</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>to print the full contents of the object <code>g</code> returned,
use <code>as.list(g)</code> or <code>print.default(g)</code></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>an object of class <code>gstat</code>, which inherits from <code>list</code>.
Its components are:</p>
<dl><dt>data</dt>
<dd><p>list; each element is a list with the <code>formula</code>, 
  <code>locations</code>, <code>data</code>, <code>nvars</code>, <code>beta</code>, etc., for a 
  variable</p></dd>

 <dt>model</dt>
<dd><p>list; each element contains a variogram model; names are
  those of the elements of <code>data</code>; cross variograms have names of
  the pairs of data elements, separated by a <code>.</code> (e.g.: 
  <code>var1.var2</code></p></dd>
</dl><p>)</p>
<dl><dt>set</dt>
<dd><p>list; named list, corresponding to set <code>name</code>=<code>value</code>;
 gstat commands (look up the set command in the gstat manual for a full list)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><a href="http://www.gstat.org/" class="external-link">http://www.gstat.org/</a> 
Pebesma, E.J., 2004. Multivariable geostatistics in S: the gstat package.
Computers and Geosciences, 30: 683-691.</p>
<p>for kriging with known, varying measurement errors (<code>weights</code>), see e.g.
Delhomme, J.P.  Kriging in the hydrosciences.  Advances in Water
Resources, 1(5):251-266, 1978; see also the section Kriging with known
measurement errors in the gstat user's manual, <a href="http://www.gstat.org/" class="external-link">http://www.gstat.org/</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Edzer Pebesma</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The function currently copies the data objects into the gstat object, so
this may become a large object. I would like to copy only the name of the
data frame, but could not get this to work. Any help is appreciated.</p>
<p>Subsetting (see examples) is done using the <code>id</code>'s of the variables,
or using numeric subsets. Subsetted gstat objects only contain cross
variograms if (i) the original gstat object contained them and (ii) the
order of the subset indexes increases, numerically, or given the order
they have in the gstat object.</p>
<p>The merge item may seem obscure. Still, for colocated cokriging, it is
needed. See texts by Goovaerts, Wackernagel, Chiles and Delfiner, or
look for standardised ordinary kriging in the 1992 Deutsch and Journel
or Isaaks and Srivastava. In these cases, two variables share a common
mean parameter. Gstat generalises this case: any two variables may share
any of the regression coefficients; allowing for instance analysis of
covariance models, when variograms were left out (see e.g. R. Christensen's
``Plane answers'' book on linear models). The tests directory of the
package contains examples in file merge.R. There is also <code>demo(pcb)</code>
which merges slopes across years, but with year-dependent intercept.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="predict.gstat.html">predict</a>, <a href="krige.html">krige</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span> <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="co"># let's do some manual fitting of two direct variograms and a cross variogram</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"ln.zinc"</span>, formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, data <span class="op">=</span> <span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span><span class="va">g</span>, id <span class="op">=</span> <span class="st">"ln.lead"</span>, formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">lead</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, data <span class="op">=</span> <span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># examine variograms and cross variogram:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="variogram.html">variogram</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gstat-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># enter direct variograms:</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span><span class="va">g</span>, id <span class="op">=</span> <span class="st">"ln.zinc"</span>, model <span class="op">=</span> <span class="fu"><a href="vgm.html">vgm</a></span><span class="op">(</span><span class="fl">.55</span>, <span class="st">"Sph"</span>, <span class="fl">900</span>, <span class="fl">.05</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span><span class="va">g</span>, id <span class="op">=</span> <span class="st">"ln.lead"</span>, model <span class="op">=</span> <span class="fu"><a href="vgm.html">vgm</a></span><span class="op">(</span><span class="fl">.55</span>, <span class="st">"Sph"</span>, <span class="fl">900</span>, <span class="fl">.05</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># enter cross variogram:</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span><span class="va">g</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ln.zinc"</span>, <span class="st">"ln.lead"</span><span class="op">)</span>, model <span class="op">=</span> <span class="fu"><a href="vgm.html">vgm</a></span><span class="op">(</span><span class="fl">.47</span>, <span class="st">"Sph"</span>, <span class="fl">900</span>, <span class="fl">.03</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># examine fit:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="variogram.html">variogram</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, model <span class="op">=</span> <span class="va">g</span><span class="op">$</span><span class="va">model</span>, main <span class="op">=</span> <span class="st">"models fitted by eye"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gstat-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># see also demo(cokriging) for a more efficient approach</span></span></span>
<span class="r-in"><span><span class="va">g</span><span class="op">[</span><span class="st">"ln.zinc"</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.zinc : formula = log(zinc)`~`1 ; data dim = 155 x 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variograms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            model psill range</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.zinc[1]   Nug  0.05     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.zinc[2]   Sph  0.55   900</span>
<span class="r-in"><span><span class="va">g</span><span class="op">[</span><span class="st">"ln.lead"</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.lead : formula = log(lead)`~`1 ; data dim = 155 x 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variograms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            model psill range</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.lead[1]   Nug  0.05     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.lead[2]   Sph  0.55   900</span>
<span class="r-in"><span><span class="va">g</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ln.zinc"</span>, <span class="st">"ln.lead"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.zinc : formula = log(zinc)`~`1 ; data dim = 155 x 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.lead : formula = log(lead)`~`1 ; data dim = 155 x 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variograms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    model psill range</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.zinc[1]           Nug  0.05     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.zinc[2]           Sph  0.55   900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.lead[1]           Nug  0.05     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.lead[2]           Sph  0.55   900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.zinc.ln.lead[1]   Nug  0.03     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.zinc.ln.lead[2]   Sph  0.47   900</span>
<span class="r-in"><span><span class="va">g</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.zinc : formula = log(zinc)`~`1 ; data dim = 155 x 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variograms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            model psill range</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.zinc[1]   Nug  0.05     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.zinc[2]   Sph  0.55   900</span>
<span class="r-in"><span><span class="va">g</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.lead : formula = log(lead)`~`1 ; data dim = 155 x 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> variograms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            model psill range</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.lead[1]   Nug  0.05     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ln.lead[2]   Sph  0.55   900</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inverse distance interpolation with inverse distance power set to .5:</span></span></span>
<span class="r-in"><span><span class="co"># (kriging variants need a variogram model to be specified)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse.grid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/gridded-methods.html" class="external-link">gridded</a></span><span class="op">(</span><span class="va">meuse.grid</span><span class="op">)</span> <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">meuse.gstat</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"zinc"</span>, formula <span class="op">=</span> <span class="va">zinc</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">meuse</span>, </span></span>
<span class="r-in"><span>  nmax <span class="op">=</span> <span class="fl">7</span>, set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>idp <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">meuse.gstat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> zinc : formula = zinc`~`1 ; data dim = 155 x 12 nmax = 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set idp = 0.5; </span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="predict.gstat.html">predict</a></span><span class="op">(</span><span class="va">meuse.gstat</span>, <span class="va">meuse.grid</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [inverse distance weighted interpolation]</span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="st">"zinc.pred"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gstat-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># see demo(cokriging) and demo(examples) for further examples, </span></span></span>
<span class="r-in"><span><span class="co"># and the manuals for predict and image</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># local universal kriging</span></span></span>
<span class="r-in"><span><span class="va">gmeuse</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"log_zinc"</span>, formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># variogram of residuals</span></span></span>
<span class="r-in"><span><span class="va">vmeuse.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit.variogram.html">fit.variogram</a></span><span class="op">(</span><span class="fu"><a href="variogram.html">variogram</a></span><span class="op">(</span><span class="va">gmeuse</span><span class="op">)</span>, <span class="fu"><a href="vgm.html">vgm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Exp"</span>, <span class="fl">300</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># prediction from local neighbourhoods within radius of 170 m or at least 10 points</span></span></span>
<span class="r-in"><span><span class="va">gmeuse</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"log_zinc"</span>, formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">meuse</span>, maxdist<span class="op">=</span><span class="fl">170</span>, nmin<span class="op">=</span><span class="fl">10</span>, force<span class="op">=</span><span class="cn">TRUE</span>, model<span class="op">=</span><span class="va">vmeuse.res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">predmeuse</span> <span class="op">&lt;-</span> <span class="fu"><a href="predict.gstat.html">predict</a></span><span class="op">(</span><span class="va">gmeuse</span>, <span class="va">meuse.grid</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using universal kriging]</span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">predmeuse</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gstat-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edzer Pebesma, Benedikt Graeler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

