<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function provides the following prediction methods:
simple, ordinary, and universal kriging, simple, ordinary, and universal
cokriging, point- or block-kriging, and conditional simulation equivalents
for each of the kriging methods."><title>Multivariable Geostatistical Prediction and Simulation — predict • gstat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multivariable Geostatistical Prediction and Simulation — predict"><meta property="og:description" content="The function provides the following prediction methods:
simple, ordinary, and universal kriging, simple, ordinary, and universal
cokriging, point- or block-kriging, and conditional simulation equivalents
for each of the kriging methods."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gstat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1-2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-spatial/gstat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multivariable Geostatistical Prediction and Simulation</h1>
      
      <div class="d-none name"><code>predict.gstat.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function provides the following prediction methods:
simple, ordinary, and universal kriging, simple, ordinary, and universal
cokriging, point- or block-kriging, and conditional simulation equivalents
for each of the kriging methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for gstat</span></span>
<span><span class="fu">predict</span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, block <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, nsim <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  indicators <span class="op">=</span> <span class="cn">FALSE</span>, BLUE <span class="op">=</span> <span class="cn">FALSE</span>, debug.level <span class="op">=</span> <span class="fl">1</span>, <span class="va">mask</span>, </span>
<span>  na.action <span class="op">=</span> <span class="va">na.pass</span>, sps.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, type <span class="op">=</span> <span class="st">"regular"</span>,</span>
<span>  offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>object of class <code>gstat</code>, see <a href="gstat.html">gstat</a> and
  <a href="krige.html">krige</a></p></dd>

<dt>newdata</dt>
<dd><p>data frame with prediction/simulation locations; should 
  contain columns with the independent variables (if present) and the
  coordinates with names as defined in <code>locations</code>; or: polygons, 
  see below</p></dd>

<dt>block</dt>
<dd><p>block size; a vector with 1, 2 or 3 values containing
  the size of a rectangular in x-, y- and z-dimension respectively
  (0 if not set), or a data frame with 1, 2 or 3 columns, containing
  the points that discretize the block in the x-, y- and z-dimension
  to define irregular blocks relative to (0,0) or (0,0,0)---see also
  the details section below. By default, predictions
  or simulations refer to the support of the data values.</p></dd>

<dt>nsim</dt>
<dd><p>integer; if set to a non-zero value, conditional simulation
  is used instead of kriging interpolation. For this, sequential Gaussian
  or indicator simulation is used (depending on the value of 
  <code>indicators</code>), following a single random path through the data.</p></dd>

<dt>indicators</dt>
<dd><p>logical; only relevant if <code>nsim</code> is non-zero; if
 TRUE, use indicator simulation, else use Gaussian simulation</p></dd>

<dt>BLUE</dt>
<dd><p>logical; if TRUE return the BLUE trend estimates only, 
if FALSE return the BLUP predictions (kriging)</p></dd>

<dt>debug.level</dt>
<dd><p>integer; set gstat internal debug level, see below
for useful values. If set to -1 (or any negative value), a progress counter
is printed</p></dd>

<dt>mask</dt>
<dd><p>not supported anymore -- use na.action; 
logical or numerical vector; pattern with valid values
in newdata (marked as TRUE, non-zero, or non-NA); if mask is specified,
the returned data frame will have the same number and order of rows 
in newdata, and masked rows will be filled with NA's.</p></dd>

<dt>na.action</dt>
<dd><p>function determining what should be done with missing
values in 'newdata'.  The default is to predict 'NA'.  Missing values 
in coordinates and predictors are both dealt with.</p></dd>

<dt>sps.args</dt>
<dd><p>when newdata is of class <code>SpatialPolygons</code> 
or <code>SpatialPolygonsDataFrame</code> this
argument list gets passed to <a href="https://edzer.github.io/sp/reference/spsample.html" class="external-link">spsample</a> to
control the discretizing of polygons</p></dd>

<dt>...</dt>
<dd><p>ignored (but necessary for the S3 generic/method consistency)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When a non-stationary (i.e., non-constant) mean is used, both
for simulation and prediction purposes the variogram model defined should
be that of the residual process, not that of the raw observations.</p>
<p>For irregular block kriging, coordinates should discretize the area
relative to (0), (0,0) or (0,0,0); the coordinates in newdata should give
the centroids around which the block should be located. So, suppose the
block is discretized by points (3,3) (3,5) (5,5) and (5,3), we should
pass point (4,4) in newdata and pass points (-1,-1) (-1,1) (1,1) (1,-1)
to the block argument. Although passing the uncentered block and (0,0)
as newdata may work for global neighbourhoods, neighbourhood selection
is always done relative to the centroid values in newdata.</p>
<p>If newdata is of class <a href="https://edzer.github.io/sp/reference/SpatialPolygons.html" class="external-link">SpatialPolygons</a>  or
<a href="https://edzer.github.io/sp/reference/SpatialPolygons.html" class="external-link">SpatialPolygonsDataFrame</a>, then the block
average for each of the polygons or polygon sets is
calculated, using <a href="https://edzer.github.io/sp/reference/spsample.html" class="external-link">spsample</a> to discretize the
polygon(s). Argument <code>sps.args</code> controls the parameters
used for <a href="https://edzer.github.io/sp/reference/spsample.html" class="external-link">spsample</a>. The "location" with respect to
which neighbourhood selection is done is for each polygon the
SpatialPolygons polygon label point; if you use local neighbourhoods
you should check out where these points are---it may be well
outside the polygon itself.</p>
<p>The algorithm used by gstat for simulation random fields is the
sequential simulation algorithm. This algorithm scales well to large or
very large fields (e.g., more than $10^6$ nodes). Its power lies in using
only data and simulated values in a local neighbourhood to approximate the
conditional distribution at that location, see <code>nmax</code> in <a href="krige.html">krige</a>
and <a href="gstat.html">gstat</a>. The larger <code>nmax</code>, the better the approximation,
the smaller <code>nmax</code>, the faster the simulation process. For selecting
the nearest <code>nmax</code> data or previously simulated points, gstat uses
a bucket PR quadtree neighbourhood search algorithm; see the reference
below.</p>
<p>For sequential Gaussian or indicator simulations, a random path through
the simulation locations is taken, which is usually done for sequential
simulations. The reason for this is that the local approximation of the
conditional distribution, using only the <code>nmax</code> neareast observed
(or simulated) values may cause spurious correlations when a regular
path would be followed. Following a single path through the locations,
gstat reuses the expensive results (neighbourhood selection and solution
to the kriging equations) for each of the subsequent simulations when
multiple realisations are requested.  You may expect a considerable speed
gain in simulating 1000 fields in a single call to predict,
compared to 1000 calls, each for simulating a single field.</p>
<p>The random number generator used for generating simulations is the native
random number generator of the environment (R, S); fixing randomness by
setting the random number seed with <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> works.</p>
<p>When mean coefficient are not supplied, they are generated as well
from their conditional distribution (assuming multivariate normal,
using the generalized least squares BLUE estimate and its estimation
covariance); for a reference to the algorithm used see Abrahamsen and
Benth, Math. Geol. 33(6), page 742 and leave out all constraints.</p>
<p>Memory requirements for sequential simulation: let n be the product of
the number of variables, the number of simulation locations, and the
number of simulations required in a single call.  the gstat C function
<code>gstat_predict</code> requires a table of size n * 12 bytes to pass the
simulations back to R, before it can free n * 4 bytes. Hopefully, R does
not have to duplicate the remaining n * 8 bytes when the coordinates
are added as columns, and when the resulting matrix is coerced to
a <code>data.frame</code>.</p>
<p>Useful values for <code>debug.level</code>: 0: suppres any output except
warning and error messages; 1: normal output (default): short data report,
program action and mode, program progress in %, total execution time;
2: print the value of all global variables, all files read and written,
and include source file name and line number in error messages; 4: print
OLS and WLS fit diagnostics; 8: print all data after reading them; 16:
print the neighbourhood selection for each prediction location; 32:
print (generalised) covariance matrices, design matrices, solutions,
kriging weights, etc.; 64: print variogram fit diagnostics (number
of iterations and variogram model in each iteration step) and order
relation violations (indicator kriging values before and after order
relation correction); 512: print block (or area) discretization data
for each prediction location. To combine settings, sum their respective
values. Negative values for <code>debug.level</code> are equal to positive,
but cause the progress counter to work.</p>
<p>For data with longitude/latitude coordinates (checked by
<code>is.projected</code>), gstat uses great circle distances in km to compute
spatial distances. The user should make sure that the semivariogram
model used is positive definite on a sphere.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a data frame containing the coordinates of <code>newdata</code>, and columns
of prediction and prediction variance (in case of kriging) or the
columns of the conditional Gaussian or indicator simulations</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>N.A.C. Cressie, 1993, Statistics for Spatial Data, Wiley.</p>
<p>Pebesma, E.J., 2004. Multivariable geostatistics in S: the gstat package.
Computers and Geosciences, 30: 683-691.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Edzer Pebesma</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="gstat.html">gstat</a>, <a href="krige.html">krige</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># generate 5 conditional simulations</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span> <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="variogram.html">variogram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit.variogram.html">fit.variogram</a></span><span class="op">(</span><span class="va">v</span>, <span class="fu"><a href="vgm.html">vgm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Sph"</span>, <span class="fl">300</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">v</span>, model <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gstat-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">131</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse.grid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/gridded-methods.html" class="external-link">gridded</a></span><span class="op">(</span><span class="va">meuse.grid</span><span class="op">)</span> <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="krige.html">krige</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, <span class="va">meuse.grid</span>, model <span class="op">=</span> <span class="va">m</span>, </span></span>
<span class="r-in"><span>  nmax <span class="op">=</span> <span class="fl">10</span>, beta <span class="op">=</span> <span class="fl">5.9</span>, nsim <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># for speed -- 10 is too small!!</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using conditional Gaussian simulation]</span>
<span class="r-in"><span><span class="co"># show all 5 simulation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gstat-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate generalised least squares residuals w.r.t. constant trend:</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="gstat.html">gstat</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="st">"log.zinc"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, model <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">blue0</span> <span class="op">&lt;-</span> <span class="fu">predict</span><span class="op">(</span><span class="va">g</span>, newdata <span class="op">=</span> <span class="va">meuse</span>, BLUE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [generalized least squares trend estimation]</span>
<span class="r-in"><span><span class="va">blue0</span><span class="op">$</span><span class="va">blue.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">$</span><span class="va">zinc</span><span class="op">)</span> <span class="op">-</span> <span class="va">blue0</span><span class="op">$</span><span class="va">log.zinc.pred</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/bubble.html" class="external-link">bubble</a></span><span class="op">(</span><span class="va">blue0</span>, zcol <span class="op">=</span> <span class="st">"blue.res"</span>, main <span class="op">=</span> <span class="st">"GLS residuals w.r.t. constant"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gstat-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate generalised least squares residuals w.r.t. linear trend:</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit.variogram.html">fit.variogram</a></span><span class="op">(</span><span class="fu"><a href="variogram.html">variogram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dist.m</span><span class="op">)</span>, <span class="va">meuse</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  <span class="fu"><a href="vgm.html">vgm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Sph"</span>, <span class="fl">300</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="gstat.html">gstat</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="st">"log.zinc"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dist.m</span><span class="op">)</span>, <span class="va">meuse</span>, model <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">blue1</span> <span class="op">&lt;-</span> <span class="fu">predict</span><span class="op">(</span><span class="va">g</span>, <span class="va">meuse</span>, BLUE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [generalized least squares trend estimation]</span>
<span class="r-in"><span><span class="va">blue1</span><span class="op">$</span><span class="va">blue.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">$</span><span class="va">zinc</span><span class="op">)</span> <span class="op">-</span> <span class="va">blue1</span><span class="op">$</span><span class="va">log.zinc.pred</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/bubble.html" class="external-link">bubble</a></span><span class="op">(</span><span class="va">blue1</span>, zcol <span class="op">=</span> <span class="st">"blue.res"</span>, </span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"GLS residuals w.r.t. linear trend"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gstat-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># unconditional simulation on a 100 x 100 grid</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/gridded-methods.html" class="external-link">gridded</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span> <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">g.dummy</span> <span class="op">&lt;-</span> <span class="fu"><a href="gstat.html">gstat</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">z</span><span class="op">~</span><span class="fl">1</span>, dummy <span class="op">=</span> <span class="cn">TRUE</span>, beta <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="fu"><a href="vgm.html">vgm</a></span><span class="op">(</span><span class="fl">1</span>,<span class="st">"Exp"</span>,<span class="fl">15</span><span class="op">)</span>, nmax <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># for speed -- 10 is too small!!</span></span></span>
<span class="r-in"><span><span class="va">yy</span> <span class="op">&lt;-</span> <span class="fu">predict</span><span class="op">(</span><span class="va">g.dummy</span>, <span class="va">xy</span>, nsim <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using unconditional Gaussian simulation]</span>
<span class="r-in"><span><span class="co"># show one realisation:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">yy</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gstat-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># show all four:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">yy</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gstat-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edzer Pebesma, Benedikt Graeler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

