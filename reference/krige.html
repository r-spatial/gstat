<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function for simple, ordinary or universal kriging (sometimes called
external drift kriging), kriging in a local neighbourhood, point kriging
or kriging of block mean values (rectangular or irregular blocks), and
conditional (Gaussian or indicator) simulation equivalents for all kriging
varieties, and function for inverse distance weighted interpolation. 
For multivariable prediction, see gstat and predict"><title>Simple, Ordinary or Universal, global or local, Point or Block Kriging, or simulation. — krige • gstat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simple, Ordinary or Universal, global or local, Point or Block Kriging, or simulation. — krige"><meta property="og:description" content="Function for simple, ordinary or universal kriging (sometimes called
external drift kriging), kriging in a local neighbourhood, point kriging
or kriging of block mean values (rectangular or irregular blocks), and
conditional (Gaussian or indicator) simulation equivalents for all kriging
varieties, and function for inverse distance weighted interpolation. 
For multivariable prediction, see gstat and predict"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gstat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1-2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-spatial/gstat/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simple, Ordinary or Universal, global or local, Point or Block Kriging, or simulation.</h1>
      
      <div class="d-none name"><code>krige.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function for simple, ordinary or universal kriging (sometimes called
external drift kriging), kriging in a local neighbourhood, point kriging
or kriging of block mean values (rectangular or irregular blocks), and
conditional (Gaussian or indicator) simulation equivalents for all kriging
varieties, and function for inverse distance weighted interpolation. 
For multivariable prediction, see <a href="gstat.html">gstat</a> and <a href="predict.gstat.html">predict</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">krige</span><span class="op">(</span><span class="va">formula</span>, <span class="va">locations</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">krige.locations</span><span class="op">(</span><span class="va">formula</span>, <span class="va">locations</span>, <span class="va">data</span>, <span class="va">newdata</span>, <span class="va">model</span>, <span class="va">...</span>, <span class="va">beta</span>, nmax</span>
<span><span class="op">=</span> <span class="cn">Inf</span>, nmin <span class="op">=</span> <span class="fl">0</span>, omax <span class="op">=</span> <span class="fl">0</span>, maxdist <span class="op">=</span> <span class="cn">Inf</span>, <span class="va">block</span>, nsim <span class="op">=</span> <span class="fl">0</span>, indicators <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>na.action <span class="op">=</span> <span class="va">na.pass</span>, debug.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">krige.spatial</span><span class="op">(</span><span class="va">formula</span>, <span class="va">locations</span>, <span class="va">newdata</span>, <span class="va">model</span>, <span class="va">...</span>, <span class="va">beta</span>, nmax</span>
<span><span class="op">=</span> <span class="cn">Inf</span>, nmin <span class="op">=</span> <span class="fl">0</span>, omax <span class="op">=</span> <span class="fl">0</span>, maxdist <span class="op">=</span> <span class="cn">Inf</span>, <span class="va">block</span>, nsim <span class="op">=</span> <span class="fl">0</span>, indicators <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>na.action <span class="op">=</span> <span class="va">na.pass</span>, debug.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">krige0</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">newdata</span>, <span class="va">model</span>, <span class="va">beta</span>, <span class="va">y</span>, <span class="va">...</span>, computeVar <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fullCovariance <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">idw</span><span class="op">(</span><span class="va">formula</span>, <span class="va">locations</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">idw.locations</span><span class="op">(</span><span class="va">formula</span>, <span class="va">locations</span>, <span class="va">data</span>, <span class="va">newdata</span>, nmax <span class="op">=</span> <span class="cn">Inf</span>, </span>
<span>  nmin <span class="op">=</span> <span class="fl">0</span>, omax <span class="op">=</span> <span class="fl">0</span>, maxdist <span class="op">=</span> <span class="cn">Inf</span>, <span class="va">block</span>, na.action <span class="op">=</span> <span class="va">na.pass</span>, idp <span class="op">=</span> <span class="fl">2.0</span>,</span>
<span>  debug.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">idw.spatial</span><span class="op">(</span><span class="va">formula</span>, <span class="va">locations</span>, <span class="va">newdata</span>, nmax <span class="op">=</span> <span class="cn">Inf</span>, nmin <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    omax <span class="op">=</span> <span class="fl">0</span>, maxdist <span class="op">=</span> <span class="cn">Inf</span>, block <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, na.action <span class="op">=</span> <span class="va">na.pass</span>, idp <span class="op">=</span> <span class="fl">2.0</span>,</span>
<span>  debug.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">idw0</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">newdata</span>, <span class="va">y</span>, idp <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>formula that defines the dependent variable as a linear
  model of independent variables; suppose the dependent variable has name
  <code>z</code>, for ordinary and simple kriging use the formula <code>z~1</code>;
  for simple kriging also define <code>beta</code> (see below); for universal
  kriging, suppose <code>z</code> is linearly dependent on <code>x</code> and <code>y</code>,
  use the formula <code>z~x+y</code></p></dd>

  <dt>locations</dt>
<dd><p>object of class <code>Spatial</code> or <code>sf</code>, or (deprecated)
  formula defines the spatial data locations (coordinates) such as <code>~x+y</code></p></dd>

 <dt>data</dt>
<dd><p>data frame: should contain the dependent variable, independent
  variables, and coordinates, should be missing if locations contains data.</p></dd>

 <dt>newdata</dt>
<dd><p>object of class <code>Spatial</code>, <code>sf</code> or <code>stars</code> with prediction/simulation 
  locations; should contain attributes with the independent variables (if present).</p></dd>

 <dt>model</dt>
<dd><p>variogram model of dependent variable (or its residuals), 
  defined by a call to <a href="vgm.html">vgm</a> or <a href="fit.variogram.html">fit.variogram</a>; for <code>krige0</code>
  also a user-supplied covariance function is allowed (see example below)</p></dd>

 <dt>beta</dt>
<dd><p>for simple kriging (and simulation based on simple
  kriging): vector with the trend coefficients (including intercept);
  if no independent variables are defined the model only contains an
  intercept and beta should be the simple kriging mean</p></dd>

 <dt>nmax</dt>
<dd><p>for local kriging: the number of nearest observations that
  should be used for a kriging prediction or simulation, where nearest
  is defined in terms of the space of the spatial locations. By default,
  all observations are used</p></dd>

 <dt>nmin</dt>
<dd><p>for local kriging: if the number of nearest observations
  within distance <code>maxdist</code> is less than <code>nmin</code>, a missing 
  value will be generated; see maxdist</p></dd>

 <dt>omax</dt>
<dd><p>see <a href="gstat.html">gstat</a></p></dd>

 <dt>maxdist</dt>
<dd><p>for local kriging: only observations within a distance
  of <code>maxdist</code> from the prediction location are used for prediction
  or simulation; if combined with <code>nmax</code>, both criteria apply</p></dd>

 <dt>block</dt>
<dd><p>block size; a vector with 1, 2 or 3 values containing
  the size of a rectangular in x-, y- and z-dimension respectively
  (0 if not set), or a data frame with 1, 2 or 3 columns, containing
  the points that discretize the block in the x-, y- and z-dimension
  to define irregular blocks relative to (0,0) or (0,0,0)---see also the details 
  section of <a href="predict.gstat.html">predict</a>. By default, predictions or simulations 
  refer to the support of the data values.</p></dd>

 <dt>nsim</dt>
<dd><p>integer; if set to a non-zero value, conditional simulation
  is used instead of kriging interpolation. For this, sequential Gaussian
  or indicator simulation is used (depending on the value of 
  <code>indicators</code>), following a single random path through the data.</p></dd>

 <dt>indicators</dt>
<dd><p>logical, only relevant if <code>nsim</code> is non-zero; if
  TRUE, use indicator simulation; else use Gaussian simulation</p></dd>

 <dt>na.action</dt>
<dd><p>function determining what should be done with missing
  values in 'newdata'.  The default is to predict 'NA'.  Missing values 
  in coordinates and predictors are both dealt with.</p></dd>

 <dt>debug.level</dt>
<dd><p>debug level, passed to <a href="predict.gstat.html">predict</a>; use -1 
 to see progress in percentage, and 0 to suppress all printed information</p></dd>

 <dt>...</dt>
<dd><p>for krige: arguments that will be passed to <a href="gstat.html">gstat</a>;
 for <code>krige0</code>: arguments that will be passe to <code>model</code></p></dd>

 <dt>idp</dt>
<dd><p>numeric; specify the inverse distance weighting power</p></dd>

 <dt>y</dt>
<dd><p>matrix; to krige multiple fields in a single step, pass data 
 as columns of matrix <code>y</code>. This will ignore the value of the 
 response in <code>formula</code>.</p></dd>

 <dt>computeVar</dt>
<dd><p>logical; if TRUE, prediction variances will be returned</p></dd>

 <dt>fullCovariance</dt>
<dd><p>logical; if FALSE a vector with prediction 
 variances will be returned, if TRUE the full covariance matrix of 
 all predictions will be returned</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    
<dl><dt>formula = "formula", locations = "formula"</dt>
<dd><p>locations specifies which coordinates in <code>data</code> refer to spatial coordinates</p></dd>

<dt>formula = "formula", locations = "Spatial"</dt>
<dd><p>Object locations knows about its own spatial locations</p></dd>

<dt>formula = "formula", locations = "NULL"</dt>
<dd><p>used in case of unconditional simulations;
newdata needs to be of class Spatial</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Function <code>krige</code> is a simple wrapper method around <a href="gstat.html">gstat</a>
and <a href="predict.gstat.html">predict</a> for univariate kriging prediction and conditional
simulation methods available in gstat. For multivariate prediction or
simulation, or for other interpolation methods provided by gstat (such as
inverse distance weighted interpolation or trend surface interpolation)
use the functions <a href="gstat.html">gstat</a> and <a href="predict.gstat.html">predict</a> directly.</p>
<p>Function <code>idw</code> performs just as <code>krige</code> without a model being
passed, but allows direct specification of the inverse distance weighting
power. Don't use with predictors in the formula.</p>
<p>For further details, see <a href="predict.gstat.html">predict</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>if <code>locations</code> is not a formula, object of the same class as
<code>newdata</code> (deriving from <code>Spatial</code>); else a data frame
containing the coordinates of <code>newdata</code>. Attributes columns
contain prediction and prediction variance (in case of kriging) or the
<code>abs(nsim)</code> columns of the conditional Gaussian or indicator
simulations</p>


<p><code>krige0</code> and <code>idw0</code> are alternative functions with reduced
functionality and larger memory requirements; they return numeric vectors
(or matrices, in case of multiple dependent) with predicted values only;
in case <code>computeVar</code> is TRUE, a list with elements <code>pred</code> and
<code>var</code> is returned, containing predictions, and (co)variances (depending
on argument <code>fullCovariance</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>N.A.C. Cressie, 1993, Statistics for Spatial Data,
Wiley.</p>
<p><a href="http://www.gstat.org/" class="external-link">http://www.gstat.org/</a></p>
<p>Pebesma, E.J., 2004. Multivariable geostatistics in S: the gstat package.
Computers and Geosciences, 30: 683-691.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Edzer Pebesma</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Daniel G. Krige is a South African scientist who was a mining engineer
when he first used generalised least squares prediction with spatial
covariances in the 50's. George Matheron coined the term <code>kriging</code>
in the 60's for the action of doing this, although very similar approaches
had been taken in the field of meteorology. Beside being Krige's name,
I consider "krige" to be to "kriging" what "predict" is to "prediction".</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="gstat.html">gstat</a>, <a href="predict.gstat.html">predict</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/" class="external-link">sp</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span> <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse.grid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/gridded-methods.html" class="external-link">gridded</a></span><span class="op">(</span><span class="va">meuse.grid</span><span class="op">)</span> <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="vgm.html">vgm</a></span><span class="op">(</span><span class="fl">.59</span>, <span class="st">"Sph"</span>, <span class="fl">874</span>, <span class="fl">.04</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># ordinary kriging:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">krige</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, <span class="va">meuse.grid</span>, model <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using ordinary kriging]</span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"var1.pred"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"ordinary kriging predictions"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="krige-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"var1.var"</span><span class="op">]</span>,  main <span class="op">=</span> <span class="st">"ordinary kriging variance"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="krige-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># simple kriging:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">krige</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, <span class="va">meuse.grid</span>, model <span class="op">=</span> <span class="va">m</span>, beta <span class="op">=</span> <span class="fl">5.9</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using simple kriging]</span>
<span class="r-in"><span><span class="co"># residual variogram:</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="vgm.html">vgm</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="st">"Sph"</span>, <span class="fl">954</span>, <span class="fl">.06</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># universal block kriging:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">krige</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">zinc</span><span class="op">)</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="va">y</span>, <span class="va">meuse</span>, <span class="va">meuse.grid</span>, model <span class="op">=</span> <span class="va">m</span>, block <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [using universal kriging]</span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"var1.pred"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"universal kriging predictions"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="krige-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># krige0, using user-defined covariance function and multiple responses in y:</span></span></span>
<span class="r-in"><span><span class="co"># exponential variogram with range 500, defined as covariance function:</span></span></span>
<span class="r-in"><span><span class="va">v</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span> <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://edzer.github.io/sp/reference/spDistsN1.html" class="external-link">spDists</a></span><span class="op">(</span><span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,<span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">500</span><span class="op">)</span> <span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># krige two variables in a single pass (using 1 covariance model):</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">$</span><span class="va">zinc</span>,<span class="va">meuse</span><span class="op">$</span><span class="va">copper</span>,<span class="va">meuse</span><span class="op">$</span><span class="va">lead</span>,<span class="va">meuse</span><span class="op">$</span><span class="va">cadmium</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">krige0</span><span class="op">(</span><span class="va">zinc</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, <span class="va">meuse.grid</span>, <span class="va">v</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">meuse.grid</span><span class="op">$</span><span class="va">zinc</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">meuse.grid</span><span class="op">[</span><span class="st">"zinc"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"zinc"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="krige-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">meuse.grid</span><span class="op">$</span><span class="va">copper</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://edzer.github.io/sp/reference/spplot.html" class="external-link">spplot</a></span><span class="op">(</span><span class="va">meuse.grid</span><span class="op">[</span><span class="st">"copper"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"copper"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="krige-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the following has NOTHING to do with kriging, but --</span></span></span>
<span class="r-in"><span><span class="co"># return the median of the nearest 11 observations:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu">krige</span><span class="op">(</span><span class="va">zinc</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, <span class="va">meuse.grid</span>, set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"med"</span><span class="op">)</span>, nmax <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [median estimation]</span>
<span class="r-in"><span><span class="co"># get 25%- and 75%-percentiles of nearest 11 obs, as prediction and variance:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu">krige</span><span class="op">(</span><span class="va">zinc</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, <span class="va">meuse.grid</span>, nmax <span class="op">=</span> <span class="fl">11</span>, </span></span>
<span class="r-in"><span>  set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"med"</span>, quantile <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [0.25-quantile estimation]</span>
<span class="r-in"><span><span class="co"># get diversity (# of different values) and mode from 11 nearest observations:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu">krige</span><span class="op">(</span><span class="va">zinc</span><span class="op">~</span><span class="fl">1</span>, <span class="va">meuse</span>, <span class="va">meuse.grid</span>, nmax <span class="op">=</span> <span class="fl">11</span>, set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"div"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [within-neighbourhood diversity and modus]</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edzer Pebesma, Benedikt Graeler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

