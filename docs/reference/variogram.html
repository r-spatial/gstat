<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate Sample or Residual Variogram or Variogram Cloud — variogram • gstat</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate Sample or Residual Variogram or Variogram Cloud — variogram" />
<meta property="og:description" content="Calculates the sample variogram from data, or in case of a linear model
is given, for the residuals, with options for directional, robust,
and pooled variogram, and for irregular distance intervals.
In case spatio-temporal data is provided, the function variogramST
is called with a different set of parameters." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gstat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0-7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/gstat/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate Sample or Residual Variogram or Variogram Cloud</h1>
    
    <div class="hidden name"><code>variogram.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the sample variogram from data, or in case of a linear model
is given, for the residuals, with options for directional, robust,
and pooled variogram, and for irregular distance intervals.</p>
<p>In case spatio-temporal data is provided, the function <code><a href='variogramST.html'>variogramST</a></code>
is called with a different set of parameters.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for gstat</span>
<span class='fu'>variogram</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for formula</span>
<span class='fu'>variogram</span><span class='op'>(</span><span class='va'>object</span>, locations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/sp/man/coordinates.html'>coordinates</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>, <span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for default</span>
<span class='fu'>variogram</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>locations</span>, <span class='va'>X</span>, <span class='va'>cutoff</span>, width <span class='op'>=</span> <span class='va'>cutoff</span><span class='op'>/</span><span class='fl'>15</span>,
  alpha <span class='op'>=</span> <span class='fl'>0</span>, beta <span class='op'>=</span> <span class='fl'>0</span>, tol.hor <span class='op'>=</span> <span class='fl'>90</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>alpha</span><span class='op'>)</span>, tol.ver <span class='op'>=</span>
  <span class='fl'>90</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>beta</span><span class='op'>)</span>, cressie <span class='op'>=</span> <span class='cn'>FALSE</span>, dX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, boundaries <span class='op'>=</span>
  <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, cloud <span class='op'>=</span> <span class='cn'>FALSE</span>, trend.beta <span class='op'>=</span> <span class='cn'>NULL</span>, debug.level <span class='op'>=</span> <span class='fl'>1</span>,
  cross <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>grid</span>, map <span class='op'>=</span> <span class='cn'>FALSE</span>, g <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span>, projected <span class='op'>=</span> <span class='cn'>TRUE</span>, 
  lambda <span class='op'>=</span> <span class='fl'>1.0</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span>, covariogram <span class='op'>=</span> <span class='cn'>FALSE</span>, PR <span class='op'>=</span> <span class='cn'>FALSE</span>, 
  pseudo <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>
<span class='co'># S3 method for gstatVariogram</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='co'># S3 method for variogramCloud</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>object of class <code>gstat</code>; in this form, direct
and cross (residual) variograms are calculated for all variables and
variable pairs defined in <code>object</code>; in case of <code>variogram.formula</code>,
formula defining the response vector and (possible) 
regressors, in case of absence of regressors, use e.g. <code>z~1</code>;
in case of <code>variogram.default</code>: list with for each variable 
the vector with responses (should not be called directly)</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data frame where the names in formula are to be found</p></td>
    </tr>
    <tr>
      <th>locations</th>
      <td><p>spatial data locations.  For variogram.formula: a
formula with only the coordinate variables in the right hand (explanatory
variable) side e.g. <code>~x+y</code>; see examples.</p>
<p>For variogram.default: list with coordinate matrices, each with the number
of rows matching that of corresponding vectors in y; the number of columns
should match the number of spatial dimensions spanned by the data (1
(x), 2 (x,y) or 3 (x,y,z)).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>any other arguments that will be passed to
variogram.default (ignored)</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>(optional) list with for each variable the matrix with
regressors/covariates; the number of rows should match that of the
correspoding element in y, the number of columns equals the number of
regressors (including intercept)</p></td>
    </tr>
    <tr>
      <th>cutoff</th>
      <td><p>spatial separation distance up to which point pairs
are included in semivariance estimates; as a default, the
length of the diagonal of the box spanning the data is divided by three.</p></td>
    </tr>
    <tr>
      <th>width</th>
      <td><p>the width of subsequent distance intervals into which
data point pairs are grouped for semivariance estimates</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>direction in  plane (x,y), in positive degrees clockwise
from positive y (North): alpha=0 for direction North (increasing y),
alpha=90 for direction East (increasing x); optional a vector of
directions in (x,y)</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>direction in z, in positive degrees up from the (x,y) plane;</p></td>
    </tr>
    <tr>
      <th>tol.hor</th>
      <td><p>horizontal tolerance angle in degrees</p></td>
    </tr>
    <tr>
      <th>tol.ver</th>
      <td><p>vertical tolerance angle in degrees</p></td>
    </tr>
    <tr>
      <th>cressie</th>
      <td><p>logical; if TRUE, use Cressie''s robust variogram estimate;
if FALSE use the classical method of moments variogram estimate</p></td>
    </tr>
    <tr>
      <th>dX</th>
      <td><p>include a pair of data points $y(s_1),y(s_2)$ taken at
locations $s_1$ and $s_2$ for sample variogram calculation only when
$||x(s_1)-x(s_2)|| &lt; dX$ with and $x(s_i)$ the vector with regressors at
location $s_i$, and $||.||$ the 2-norm.  This allows pooled estimation of
within-strata variograms (use a factor variable as regressor, and dX=0.5),
or variograms of (near-)replicates in a linear model (addressing point
pairs having similar values for regressors variables)</p></td>
    </tr>
    <tr>
      <th>boundaries</th>
      <td><p>numerical vector with distance interval upper boundaries; 
values should be strictly increasing</p></td>
    </tr>
    <tr>
      <th>cloud</th>
      <td><p>logical; if TRUE, calculate the semivariogram cloud</p></td>
    </tr>
    <tr>
      <th>trend.beta</th>
      <td><p>vector with trend coefficients, in case they are
known. By default, trend coefficients are estimated from the data.</p></td>
    </tr>
    <tr>
      <th>debug.level</th>
      <td><p>integer; set gstat internal debug level</p></td>
    </tr>
    <tr>
      <th>cross</th>
      <td><p>logical or character; if FALSE, no cross variograms are computed
when object is of class <code>gstat</code> and has more than one variable; if
TRUE, all direct and cross variograms are computed; if
equal to "ST", direct and cross variograms are computed for all pairs 
involving the first (non-time lagged) variable; if equal to "ONLY",
only cross variograms are computed (no direct variograms).</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>formula, specifying the dependent variable and possible covariates</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>object of class <code>variogram</code> or <code>variogramCloud</code>
to be printed</p></td>
    </tr>
    <tr>
      <th>grid</th>
      <td><p>grid parameters, if data are gridded (not to be called
directly; this is filled automatically)</p></td>
    </tr>
    <tr>
      <th>map</th>
      <td><p>logical; if TRUE, and <code>cutoff</code> and <code>width</code>
are given, a variogram map is returned. This requires package
sp. Alternatively, a map can be passed, of class SpatialDataFrameGrid
(see sp docs)</p></td>
    </tr>
    <tr>
      <th>g</th>
      <td><p>NULL or object of class gstat; may be used to pass settable
parameters and/or variograms; see example</p></td>
    </tr>
    <tr>
      <th>projected</th>
      <td><p>logical; if FALSE, data are assumed to be unprojected,
meaning decimal longitude/latitude. For projected data, Euclidian
distances are computed, for unprojected great circle distances
(km). In <code>variogram.formula</code> or <code>variogram.gstat</code>, for data
deriving from class Spatial, projection is detected automatically using
<code>is.projected</code></p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>test feature; not working (yet)</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical; print some progress indication</p></td>
    </tr>
    <tr>
      <th>pseudo</th>
      <td><p>integer; use pseudo cross variogram for computing
time-lagged spatial variograms? -1: find out from coordinates -- if they
are equal then yes, else no; 0: no; 1: yes.</p></td>
    </tr>
    <tr>
      <th>covariogram</th>
      <td><p>logical; compute covariogram instead of variogram?</p></td>
    </tr>
    <tr>
      <th>PR</th>
      <td><p>logical; compute pairwise relative variogram (does NOT check
whether variable is strictly positive)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If map is TRUE (or a map is passed), a grid map is returned
containing the (cross) variogram map(s). See package sp.</p>
<p>In other cases, an object of class "gstatVariogram" with the 
following fields:</p>
<dt>np</dt><dd><p>the number of point pairs for this estimate; 
in case of a <code>variogramCloud</code> see below</p></dd>
<dt>dist</dt><dd><p>the average distance of all point pairs considered
for this estimate</p></dd>
<dt>gamma</dt><dd><p>the actual sample variogram estimate</p></dd>
<dt>dir.hor</dt><dd><p>the horizontal direction</p></dd>
<dt>dir.ver</dt><dd><p>the vertical direction</p></dd>
<dt>id</dt><dd><p>the combined id pair</p></dd>

If cloud is TRUE: an object of class variogramCloud, with the field
np encoding the numbers of the point pair that contributed to a
variogram cloud estimate, as follows. The first point is found by 1 + the
integer division of np by the .BigInt attribute of the returned
object, the second point by 1 + the remainder of that division. 
as.data.frame.variogramCloud returns no np field,
but does the decoding into:
<dt>left</dt><dd><p>for variogramCloud: data id (row number) of one of 
the data pair</p></dd>
<dt>right</dt><dd><p>for variogramCloud: data id (row number) of the other 
data in the pair</p></dd>

In case of a spatio-temporal variogram is sought see <a href='variogramST.html'>variogramST</a> 
for details.

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><code>variogram.default</code> should not be called by users directly,
as it makes many assumptions about the organization of the data, that
are not fully documented (but of course, can be understood from reading
the source code of the other <code>variogram</code> methods)</p>
<p>Successfully setting <code>gridded() &lt;- TRUE</code> may trigger a branch that
will fail unless dx and dy are identical, and not merely similar
to within machine epsilon.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cressie, N.A.C., 1993, Statistics for Spatial Data, Wiley.</p>
<p>Cressie, N., C. Wikle, 2011, Statistics for Spatio-temporal Data, Wiley.</p>
<p><a href='http://www.gstat.org/'>http://www.gstat.org/</a></p>
<p>Pebesma, E.J., 2004. Multivariable geostatistics in S: the gstat package.
Computers \&amp; Geosciences, 30: 683-691.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Edzer Pebesma</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><code>variogram.line</code> is DEPRECATED; it is and was never meant as a variogram
method, but works automatically as such by the R dispatch system. Use
variogramLine instead.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>print.gstatVariogram,
<a href='plot.gstatVariogram.html'>plot.gstatVariogram</a>,
<a href='plot.variogramCloud.html'>plot.variogramCloud</a>;
for variogram models: <a href='vgm.html'>vgm</a>,
to fit a variogram model to a sample variogram: 
<a href='fit.variogram.html'>fit.variogram</a>
<code><a href='variogramST.html'>variogramST</a></code> for details on the spatio-temporal sample variogram.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/edzer/sp/'>sp</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>meuse</span><span class='op'>)</span>
<span class='co'># no trend:</span>
<span class='fu'><a href='https://rdrr.io/pkg/sp/man/coordinates.html'>coordinates</a></span><span class='op'>(</span><span class='va'>meuse</span><span class='op'>)</span> <span class='op'>=</span> <span class='op'>~</span><span class='va'>x</span><span class='op'>+</span><span class='va'>y</span>
<span class='fu'>variogram</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span><span class='op'>~</span><span class='fl'>1</span>, <span class='va'>meuse</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     np       dist     gamma dir.hor dir.ver   id
#&gt; 1   57   79.29244 0.1234479       0       0 var1
#&gt; 2  299  163.97367 0.2162185       0       0 var1
#&gt; 3  419  267.36483 0.3027859       0       0 var1
#&gt; 4  457  372.73542 0.4121448       0       0 var1
#&gt; 5  547  478.47670 0.4634128       0       0 var1
#&gt; 6  533  585.34058 0.5646933       0       0 var1
#&gt; 7  574  693.14526 0.5689683       0       0 var1
#&gt; 8  564  796.18365 0.6186769       0       0 var1
#&gt; 9  589  903.14650 0.6471479       0       0 var1
#&gt; 10 543 1011.29177 0.6915705       0       0 var1
#&gt; 11 500 1117.86235 0.7033984       0       0 var1
#&gt; 12 477 1221.32810 0.6038770       0       0 var1
#&gt; 13 452 1329.16407 0.6517158       0       0 var1
#&gt; 14 457 1437.25620 0.5665318       0       0 var1
#&gt; 15 415 1543.20248 0.5748227       0       0 var1</div><div class='input'><span class='co'># residual variogram w.r.t. a linear trend:</span>
<span class='fu'>variogram</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span><span class='op'>~</span><span class='va'>x</span><span class='op'>+</span><span class='va'>y</span>, <span class='va'>meuse</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     np       dist     gamma dir.hor dir.ver   id
#&gt; 1   57   79.29244 0.1060834       0       0 var1
#&gt; 2  299  163.97367 0.1829983       0       0 var1
#&gt; 3  419  267.36483 0.2264256       0       0 var1
#&gt; 4  457  372.73542 0.2847192       0       0 var1
#&gt; 5  547  478.47670 0.3162418       0       0 var1
#&gt; 6  533  585.34058 0.3571578       0       0 var1
#&gt; 7  574  693.14526 0.3701742       0       0 var1
#&gt; 8  564  796.18365 0.4201289       0       0 var1
#&gt; 9  589  903.14650 0.4216983       0       0 var1
#&gt; 10 543 1011.29177 0.4772549       0       0 var1
#&gt; 11 500 1117.86235 0.5075874       0       0 var1
#&gt; 12 477 1221.32810 0.4617632       0       0 var1
#&gt; 13 452 1329.16407 0.5512305       0       0 var1
#&gt; 14 457 1437.25620 0.4352155       0       0 var1
#&gt; 15 415 1543.20248 0.4556815       0       0 var1</div><div class='input'><span class='co'># directional variogram:</span>
<span class='fu'>variogram</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span><span class='op'>~</span><span class='va'>x</span><span class='op'>+</span><span class='va'>y</span>, <span class='va'>meuse</span>, alpha<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>45</span>,<span class='fl'>90</span>,<span class='fl'>135</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     np       dist      gamma dir.hor dir.ver   id
#&gt; 1   12   84.36080 0.04114593       0       0 var1
#&gt; 2   76  165.59800 0.19091543       0       0 var1
#&gt; 3  109  270.29441 0.21867508       0       0 var1
#&gt; 4  134  371.27824 0.23112878       0       0 var1
#&gt; 5  158  478.06480 0.38337565       0       0 var1
#&gt; 6  154  583.35601 0.35513567       0       0 var1
#&gt; 7  159  692.50911 0.35709265       0       0 var1
#&gt; 8  158  797.52941 0.46221222       0       0 var1
#&gt; 9  156  901.86529 0.47081724       0       0 var1
#&gt; 10 156 1011.55318 0.50937290       0       0 var1
#&gt; 11 137 1115.24492 0.57358764       0       0 var1
#&gt; 12 135 1220.31674 0.43193998       0       0 var1
#&gt; 13 109 1328.07859 0.68882673       0       0 var1
#&gt; 14 120 1436.93237 0.53015452       0       0 var1
#&gt; 15  96 1544.68559 0.66909962       0       0 var1
#&gt; 16  11   82.06663 0.07619858      45       0 var1
#&gt; 17  91  165.75829 0.11957011      45       0 var1
#&gt; 18 118  266.93093 0.20557549      45       0 var1
#&gt; 19 136  374.24886 0.27864922      45       0 var1
#&gt; 20 172  479.40618 0.23932562      45       0 var1
#&gt; 21 177  587.53554 0.28038440      45       0 var1
#&gt; 22 209  693.02620 0.34028114      45       0 var1
#&gt; 23 226  796.37554 0.37201935      45       0 var1
#&gt; 24 283  905.25038 0.36146985      45       0 var1
#&gt; 25 264 1012.26326 0.36891951      45       0 var1
#&gt; 26 274 1121.20926 0.36831067      45       0 var1
#&gt; 27 275 1221.63704 0.33875319      45       0 var1
#&gt; 28 282 1330.93431 0.33848846      45       0 var1
#&gt; 29 297 1438.21262 0.31476883      45       0 var1
#&gt; 30 299 1542.75515 0.31707228      45       0 var1
#&gt; 31  16   78.75466 0.07583160      90       0 var1
#&gt; 32  70  160.01667 0.20149652      90       0 var1
#&gt; 33  97  267.68973 0.20686187      90       0 var1
#&gt; 34  98  372.02688 0.28167260      90       0 var1
#&gt; 35 118  479.76226 0.30366429      90       0 var1
#&gt; 36  98  585.85589 0.46344817      90       0 var1
#&gt; 37 115  691.04342 0.36401272      90       0 var1
#&gt; 38 100  796.22142 0.36912878      90       0 var1
#&gt; 39  88  901.26201 0.50261434      90       0 var1
#&gt; 40  72 1004.66642 0.56369456      90       0 var1
#&gt; 41  68 1109.43463 0.77219638      90       0 var1
#&gt; 42  51 1223.73294 0.79679699      90       0 var1
#&gt; 43  44 1322.80887 0.82262644      90       0 var1
#&gt; 44  30 1430.99001 0.80073011      90       0 var1
#&gt; 45  16 1544.27842 1.17421050      90       0 var1
#&gt; 46  18   74.69621 0.19452856     135       0 var1
#&gt; 47  62  163.83075 0.24550456     135       0 var1
#&gt; 48  95  264.21071 0.28119200     135       0 var1
#&gt; 49  89  373.39690 0.37803627     135       0 var1
#&gt; 50  99  475.98691 0.35772223     135       0 var1
#&gt; 51 104  584.05805 0.39065627     135       0 var1
#&gt; 52  91  697.18636 0.46947283     135       0 var1
#&gt; 53  80  792.93648 0.53667425     135       0 var1
#&gt; 54  62  899.44175 0.45817366     135       0 var1
#&gt; 55  51 1014.81674 0.81777411     135       0 var1
#&gt; 56  21 1118.55839 1.03741404     135       0 var1
#&gt; 57  16 1216.88607 1.75971197     135       0 var1
#&gt; 58  17 1323.20745 2.49557308     135       0 var1
#&gt; 59  10 1431.53529 1.77666963     135       0 var1
#&gt; 60   4 1536.74264 2.82057119     135       0 var1</div><div class='input'><span class='fu'>variogram</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span><span class='op'>~</span><span class='fl'>1</span>, <span class='va'>meuse</span>, width<span class='op'>=</span><span class='fl'>90</span>, cutoff<span class='op'>=</span><span class='fl'>1300</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     np       dist     gamma dir.hor dir.ver   id
#&gt; 1   41   72.24836 0.1404979       0       0 var1
#&gt; 2  212  142.88031 0.1719093       0       0 var1
#&gt; 3  320  227.32202 0.2554929       0       0 var1
#&gt; 4  371  315.85549 0.3469081       0       0 var1
#&gt; 5  423  406.44801 0.4255276       0       0 var1
#&gt; 6  458  496.09401 0.5042025       0       0 var1
#&gt; 7  455  586.78634 0.5650016       0       0 var1
#&gt; 8  466  677.39566 0.5478706       0       0 var1
#&gt; 9  503  764.55712 0.6076682       0       0 var1
#&gt; 10 480  856.69422 0.6852387       0       0 var1
#&gt; 11 468  944.02864 0.6516089       0       0 var1
#&gt; 12 460 1033.62277 0.6797202       0       0 var1
#&gt; 13 422 1125.63214 0.7001957       0       0 var1
#&gt; 14 408 1212.62350 0.6145586       0       0 var1
#&gt; 15 173 1280.65364 0.6213803       0       0 var1</div><div class='input'>
<span class='co'># GLS residual variogram:</span>
<span class='va'>v</span> <span class='op'>=</span> <span class='fu'>variogram</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span><span class='op'>~</span><span class='va'>x</span><span class='op'>+</span><span class='va'>y</span>, <span class='va'>meuse</span><span class='op'>)</span>
<span class='va'>v.fit</span> <span class='op'>=</span> <span class='fu'><a href='fit.variogram.html'>fit.variogram</a></span><span class='op'>(</span><span class='va'>v</span>, <span class='fu'><a href='vgm.html'>vgm</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='st'>"Sph"</span>, <span class='fl'>700</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>v.fit</span>
</div><div class='output co'>#&gt;   model      psill    range
#&gt; 1   Nug 0.08234213    0.000
#&gt; 2   Sph 0.38866509 1098.571</div><div class='input'><span class='va'>set</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>gls<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>v</span>
</div><div class='output co'>#&gt;     np       dist     gamma dir.hor dir.ver   id
#&gt; 1   57   79.29244 0.1060834       0       0 var1
#&gt; 2  299  163.97367 0.1829983       0       0 var1
#&gt; 3  419  267.36483 0.2264256       0       0 var1
#&gt; 4  457  372.73542 0.2847192       0       0 var1
#&gt; 5  547  478.47670 0.3162418       0       0 var1
#&gt; 6  533  585.34058 0.3571578       0       0 var1
#&gt; 7  574  693.14526 0.3701742       0       0 var1
#&gt; 8  564  796.18365 0.4201289       0       0 var1
#&gt; 9  589  903.14650 0.4216983       0       0 var1
#&gt; 10 543 1011.29177 0.4772549       0       0 var1
#&gt; 11 500 1117.86235 0.5075874       0       0 var1
#&gt; 12 477 1221.32810 0.4617632       0       0 var1
#&gt; 13 452 1329.16407 0.5512305       0       0 var1
#&gt; 14 457 1437.25620 0.4352155       0       0 var1
#&gt; 15 415 1543.20248 0.4556815       0       0 var1</div><div class='input'><span class='va'>g</span> <span class='op'>=</span> <span class='fu'><a href='gstat.html'>gstat</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='st'>"log-zinc"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span><span class='op'>~</span><span class='va'>x</span><span class='op'>+</span><span class='va'>y</span>, <span class='va'>meuse</span>, model<span class='op'>=</span><span class='va'>v.fit</span>, set <span class='op'>=</span> <span class='va'>set</span><span class='op'>)</span>
<span class='fu'>variogram</span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     np       dist     gamma dir.hor dir.ver       id
#&gt; 1   57   79.29244 0.1059824       0       0 log-zinc
#&gt; 2  299  163.97367 0.1826061       0       0 log-zinc
#&gt; 3  419  267.36483 0.2256105       0       0 log-zinc
#&gt; 4  457  372.73542 0.2839247       0       0 log-zinc
#&gt; 5  547  478.47670 0.3156087       0       0 log-zinc
#&gt; 6  533  585.34058 0.3566519       0       0 log-zinc
#&gt; 7  574  693.14526 0.3686387       0       0 log-zinc
#&gt; 8  564  796.18365 0.4203337       0       0 log-zinc
#&gt; 9  589  903.14650 0.4212182       0       0 log-zinc
#&gt; 10 543 1011.29177 0.4766290       0       0 log-zinc
#&gt; 11 500 1117.86235 0.5089493       0       0 log-zinc
#&gt; 12 477 1221.32810 0.4637839       0       0 log-zinc
#&gt; 13 452 1329.16407 0.5501712       0       0 log-zinc
#&gt; 14 457 1437.25620 0.4388564       0       0 log-zinc
#&gt; 15 415 1543.20248 0.4580371       0       0 log-zinc</div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='http://rgdal.r-forge.r-project.org'>rgdal</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/pkg/sp/man/is.projected.html'>proj4string</a></span><span class='op'>(</span><span class='va'>meuse</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'><a href='http://rgdal.r-forge.r-project.org/reference/CRS-class.html'>CRS</a></span><span class='op'>(</span><span class='st'>"+init=epsg:28992"</span><span class='op'>)</span>
  <span class='va'>meuse.ll</span> <span class='op'>=</span> <span class='fu'><a href='http://rgdal.r-forge.r-project.org/reference/spTransform-methods.html'>spTransform</a></span><span class='op'>(</span><span class='va'>meuse</span>, <span class='fu'><a href='http://rgdal.r-forge.r-project.org/reference/CRS-class.html'>CRS</a></span><span class='op'>(</span><span class='st'>"+proj=longlat +datum=WGS84"</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># variogram of unprojected data, using great-circle distances, returning km as units</span>
  <span class='fu'>variogram</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span> <span class='op'>~</span> <span class='fl'>1</span>, <span class='va'>meuse.ll</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: rgdal</span></div><div class='output co'>#&gt; <span class='message'>rgdal: version: 1.5-18, (SVN revision 1082)</span>
#&gt; <span class='message'>Geospatial Data Abstraction Library extensions to R successfully loaded</span>
#&gt; <span class='message'>Loaded GDAL runtime: GDAL 3.1.3, released 2020/09/01</span>
#&gt; <span class='message'>Path to GDAL shared files: /usr/share/gdal</span>
#&gt; <span class='message'>GDAL binary built with GEOS: TRUE </span>
#&gt; <span class='message'>Loaded PROJ runtime: Rel. 7.2.0, November 1st, 2020, [PJ_VERSION: 720]</span>
#&gt; <span class='message'>Path to PROJ shared files: /home/edzer/.local/share/proj:/usr/share/proj</span>
#&gt; <span class='message'>PROJ CDN enabled: FALSE</span>
#&gt; <span class='message'>Linking to sp version:1.4-4</span>
#&gt; <span class='message'>To mute warnings of possible GDAL/OSR exportToProj4() degradation,</span>
#&gt; <span class='message'>use options("rgdal_show_exportToProj4_warnings"="none") before loading rgdal.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum Amersfoort in CRS definition</span></div><div class='output co'>#&gt;     np       dist     gamma dir.hor dir.ver   id
#&gt; 1   57 0.07929104 0.1234479       0       0 var1
#&gt; 2  299 0.16397078 0.2162185       0       0 var1
#&gt; 3  419 0.26736014 0.3027859       0       0 var1
#&gt; 4  457 0.37272890 0.4121448       0       0 var1
#&gt; 5  548 0.47856656 0.4626633       0       0 var1
#&gt; 6  533 0.58553009 0.5646904       0       0 var1
#&gt; 7  573 0.69322813 0.5698718       0       0 var1
#&gt; 8  566 0.79636575 0.6169183       0       0 var1
#&gt; 9  587 0.90330623 0.6489406       0       0 var1
#&gt; 10 544 1.01137212 0.6932668       0       0 var1
#&gt; 11 500 1.11805589 0.7009152       0       0 var1
#&gt; 12 479 1.22176407 0.6044300       0       0 var1
#&gt; 13 450 1.32960776 0.6507175       0       0 var1
#&gt; 14 456 1.43734917 0.5675707       0       0 var1
#&gt; 15 415 1.54317675 0.5748227       0       0 var1</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edzer Pebesma, Benedikt Graeler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


