<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate, or Add to Variogram Model — vgm • gstat</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Generate, or Add to Variogram Model — vgm" />

<meta property="og:description" content="Generates a variogram model, or adds to an existing model. 
print.variogramModel prints the essence of a variogram  model." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gstat</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/gstat/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate, or Add to Variogram Model</h1>
    
    <div class="hidden name"><code>vgm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Generates a variogram model, or adds to an existing model. 
<code>print.variogramModel</code> prints the essence of a variogram  model.</p>
    
    </div>

    <pre class="usage"><span class='fu'>vgm</span>(<span class='kw'>psill</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='no'>model</span>, <span class='kw'>range</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='no'>nugget</span>, <span class='no'>add.to</span>, <span class='no'>anis</span>, <span class='kw'>kappa</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='no'>...</span>, <span class='no'>covtable</span>,
        <span class='kw'>Err</span> <span class='kw'>=</span> <span class='fl'>0</span>)
<span class='co'># S3 method for variogramModel</span>
<span class='fu'>print</span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='co'># S3 method for variogramModel</span>
<span class='fu'>plot</span>(<span class='no'>x</span>, <span class='no'>cutoff</span>, <span class='no'>...</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>'l'</span>)
<span class='fu'>as.vgm.variomodel</span>(<span class='no'>m</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>psill</th>
      <td><p>(partial) sill of the variogram model component, or model: see Details</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>model type, e.g. "Exp", "Sph", "Gau", "Mat". Calling vgm() without
a model argument returns a data.frame with available models.</p></td>
    </tr>
    <tr>
      <th>range</th>
      <td><p>range parameter of the variogram model component; in case of anisotropy: major range</p></td>
    </tr>
    <tr>
      <th>kappa</th>
      <td><p>smoothness parameter for the Matern class of variogram 
models</p></td>
    </tr>
    <tr>
      <th>nugget</th>
      <td><p>nugget component of the variogram (this basically adds a nugget
compontent to the model); if missing, nugget component is omitted</p></td>
    </tr>
    <tr>
      <th>add.to</th>
      <td><p>the variogram model to which we want to add a component (structure)</p></td>
    </tr>
    <tr>
      <th>anis</th>
      <td><p>anisotropy parameters: see notes below</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>a variogram model to print or plot</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments that will be passed to <code>print</code>, e.g. <code>digits</code>
(see examples), or to <code>variogramLine</code> for the plot method</p></td>
    </tr>
    <tr>
      <th>covtable</th>
      <td><p>if model is <code>Tab</code>, instead of model parameters a one-dimensional 
covariance table can be passed here. See covtable.R in tests directory, and example below.</p></td>
    </tr>
    <tr>
      <th>Err</th>
      <td><p>numeric; if larger than zero, the measurement error variance
component that will not be included to the kriging equations, i.e. kriging
will now smooth the process Y instead of predict the measured Z, 
where Z=Y+e, and Err is the variance of e</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>object of class <code>variomodel</code>, see <span class="pkg">geoR</span></p></td>
    </tr>
    <tr>
      <th>cutoff</th>
      <td><p>maximum distance up to which variogram values are computed</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>plot type</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If a single model is passed, an object of class <code>variogramModel</code>
extending <code>data.frame</code>.</p>
<p>In case a vector ofmodels is passed, an object of class
<code>variogramModelList</code> which is a list of <code>variogramModel</code>
objects.</p>
<p>When called without a model argument, a data.frame with available models
is returned, having two columns: short (abbreviated names, to be used
as model argument: "Exp", "Sph" etc) and long (with some description).</p>
<p>as.vgm.variomodel tries to convert an object of class variomodel (geoR)
to vgm.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If only the first argument (<code>psill</code>) is given a
<code>character</code> value indicating a model, as in <code>vgm("Sph")</code>,
then this taken as a shorthand form of <code>vgm(NA,"Sph",NA,NA)</code>,
i.e. a spherical variogram with nugget and unknown parameter values;
see examples below. Read <a href='fit.variogram.html'>fit.variogram</a> to find out how
<code>NA</code> variogram parameters are given initial values for a fitting
a model, based on the sample variogram. Package <code>automap</code>
gives further options for automated variogram modelling.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Geometric anisotropy can be modelled for each individual simple model
by giving two or five anisotropy parameters, two for two-dimensional
and five for three-dimensional data. In any case, the range defined
is the range in the direction of the strongest correlation, or the
major range. Anisotropy parameters define which direction this is (the
main axis), and how much shorter the range is in (the) direction(s)
perpendicular to this main axis.</p>
<p>In two dimensions, two parameters define an anisotropy ellipse, say
<code>anis = c(30, 0.5)</code>. The first parameter, <code>30</code>, refers to
the main axis direction: it is the angle for the principal direction
of continuity (measured in degrees, clockwise from positive Y, i.e. North).
The second parameter, <code>0.5</code>, is the anisotropy ratio, the ratio
of the minor range to the major range (a value between 0 and 1).  So,
in our example, if the range in the major direction (North-East) is 100,
the range in the minor direction (South-East) is 0.5 x 100 = 50.</p>
<p>In three dimensions, five values should be given in the form <code>anis
= c(p,q,r,s,t)</code>.  Now, $p$ is the angle for the principal direction of
continuity (measured in degrees, clockwise from Y, in direction of X),
$q$ is the dip angle for the principal direction of continuity (measured
in positive degrees up from horizontal), $r$ is the third rotation angle
to rotate the two minor directions around the principal direction defined
by $p$ and $q$. A positive angle acts counter-clockwise while looking
in the principal direction. Anisotropy ratios $s$ and $t$ are the ratios
between the major range and each of the two minor ranges. The anisotropy code
was taken from GSLIB. Note that in <a href='http://www.gslib.com/sec_gb.html'>http://www.gslib.com/sec_gb.html</a>
it is reported that this code has a bug. Quoting from this
site: ``The third angle in all GSLIB programs operates in the opposite
direction than specified in the GSLIB book.  Explanation - The books
says (pp27) the angle is measured clockwise when looking toward
the origin (from the postive principal direction), but it should be
counter-clockwise. This is a documentation error. Although rarely used,
the correct specification of the third angle is critical if used.''</p>
<p>(Note that <code>anis = c(p,s)</code> is equivalent to <code>anis = c(p,0,0,s,1)</code>.)</p>
<p>The implementation in gstat for 2D and 3D anisotropy was taken from
the gslib (probably 1992) code.  I have seen a paper where it is argued
that the 3D anisotropy code implemented in gslib (and so in gstat)
is in error, but I have not corrected anything afterwards.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href='http://www.gstat.org/'>http://www.gstat.org/</a></p>
<p>Pebesma, E.J., 2004. Multivariable geostatistics in S: the gstat package.
Computers \&amp; Geosciences, 30: 683-691.</p>
<p>Deutsch, C.V. and Journel, A.G., 1998.  GSLIB: Geostatistical software
library and user's guide, second edition, Oxford University Press.</p>
<p>For the validity of variogram models on the sphere, see Huang,
Chunfeng, Haimeng Zhang, and Scott M. Robeson. On the validity
of commonly used covariance and variogram functions on the
sphere. Mathematical Geosciences 43.6 (2011): 721-733.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='show.vgms.html'>show.vgms</a> to view the available models,
<a href='fit.variogram.html'>fit.variogram</a>,
<a href='variogramLine.html'>variogramLine</a>,
<a href='variogram.html'>variogram</a> for the sample variogram.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>vgm</span>()</div><div class='output co'>#&gt;    short                                      long
#&gt; 1    Nug                              Nug (nugget)
#&gt; 2    Exp                         Exp (exponential)
#&gt; 3    Sph                           Sph (spherical)
#&gt; 4    Gau                            Gau (gaussian)
#&gt; 5    Exc        Exclass (Exponential class/stable)
#&gt; 6    Mat                              Mat (Matern)
#&gt; 7    Ste Mat (Matern, M. Stein's parameterization)
#&gt; 8    Cir                            Cir (circular)
#&gt; 9    Lin                              Lin (linear)
#&gt; 10   Bes                              Bes (bessel)
#&gt; 11   Pen                      Pen (pentaspherical)
#&gt; 12   Per                            Per (periodic)
#&gt; 13   Wav                                Wav (wave)
#&gt; 14   Hol                                Hol (hole)
#&gt; 15   Log                         Log (logarithmic)
#&gt; 16   Pow                               Pow (power)
#&gt; 17   Spl                              Spl (spline)
#&gt; 18   Leg                            Leg (Legendre)
#&gt; 19   Err                   Err (Measurement error)
#&gt; 20   Int                           Int (Intercept)</div><div class='input'><span class='fu'>vgm</span>(<span class='st'>"Sph"</span>)</div><div class='output co'>#&gt;   model psill range
#&gt; 1   Nug    NA     0
#&gt; 2   Sph    NA    NA</div><div class='input'><span class='fu'>vgm</span>(<span class='fl'>NA</span>, <span class='st'>"Sph"</span>, <span class='fl'>NA</span>, <span class='fl'>NA</span>)</div><div class='output co'>#&gt;   model psill range
#&gt; 1   Nug    NA     0
#&gt; 2   Sph    NA    NA</div><div class='input'><span class='fu'>vgm</span>(, <span class='st'>"Sph"</span>) <span class='co'># "Sph" is second argument: NO nugget in this case</span></div><div class='output co'>#&gt;   model psill range
#&gt; 1   Sph    NA    NA</div><div class='input'><span class='fu'>vgm</span>(<span class='fl'>10</span>, <span class='st'>"Exp"</span>, <span class='fl'>300</span>)</div><div class='output co'>#&gt;   model psill range
#&gt; 1   Exp    10   300</div><div class='input'><span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>vgm</span>(<span class='fl'>10</span>, <span class='st'>"Exp"</span>, <span class='fl'>300</span>)
<span class='fu'>vgm</span>(<span class='fl'>10</span>, <span class='st'>"Nug"</span>, <span class='fl'>0</span>)</div><div class='output co'>#&gt;   model psill range
#&gt; 1   Nug    10     0</div><div class='input'><span class='fu'>vgm</span>(<span class='fl'>10</span>, <span class='st'>"Exp"</span>, <span class='fl'>300</span>, <span class='fl'>4.5</span>)</div><div class='output co'>#&gt;   model psill range
#&gt; 1   Nug   4.5     0
#&gt; 2   Exp  10.0   300</div><div class='input'><span class='fu'>vgm</span>(<span class='fl'>10</span>, <span class='st'>"Mat"</span>, <span class='fl'>300</span>, <span class='fl'>4.5</span>, <span class='kw'>kappa</span> <span class='kw'>=</span> <span class='fl'>0.7</span>)</div><div class='output co'>#&gt;   model psill range kappa
#&gt; 1   Nug   4.5     0   0.0
#&gt; 2   Mat  10.0   300   0.7</div><div class='input'><span class='fu'>vgm</span>( <span class='fl'>5</span>, <span class='st'>"Exp"</span>, <span class='fl'>300</span>, <span class='kw'>add.to</span> <span class='kw'>=</span> <span class='fu'>vgm</span>(<span class='fl'>5</span>, <span class='st'>"Exp"</span>, <span class='fl'>60</span>, <span class='kw'>nugget</span> <span class='kw'>=</span> <span class='fl'>2.5</span>))</div><div class='output co'>#&gt;   model psill range
#&gt; 1   Nug   2.5     0
#&gt; 2   Exp   5.0    60
#&gt; 3   Exp   5.0   300</div><div class='input'><span class='fu'>vgm</span>(<span class='fl'>10</span>, <span class='st'>"Exp"</span>, <span class='fl'>300</span>, <span class='kw'>anis</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>30</span>, <span class='fl'>0.5</span>))</div><div class='output co'>#&gt;   model psill range ang1 anis1
#&gt; 1   Exp    10   300   30   0.5</div><div class='input'><span class='fu'>vgm</span>(<span class='fl'>10</span>, <span class='st'>"Exp"</span>, <span class='fl'>300</span>, <span class='kw'>anis</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>30</span>, <span class='fl'>10</span>, <span class='fl'>0</span>, <span class='fl'>0.5</span>, <span class='fl'>0.3</span>))</div><div class='output co'>#&gt;   model psill range ang1 ang2 ang3 anis1 anis2
#&gt; 1   Exp    10   300   30   10    0   0.5   0.3</div><div class='input'><span class='co'># Matern variogram model:</span>
<span class='fu'>vgm</span>(<span class='fl'>1</span>, <span class='st'>"Mat"</span>, <span class='fl'>1</span>, <span class='kw'>kappa</span><span class='kw'>=</span><span class='fl'>.3</span>)</div><div class='output co'>#&gt;   model psill range kappa
#&gt; 1   Mat     1     1   0.3</div><div class='input'><span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>vgm</span>(<span class='fl'>0.39527463</span>, <span class='st'>"Sph"</span>, <span class='fl'>953.8942</span>, <span class='kw'>nugget</span> <span class='kw'>=</span> <span class='fl'>0.06105141</span>)
<span class='no'>x</span></div><div class='output co'>#&gt;   model      psill    range
#&gt; 1   Nug 0.06105141   0.0000
#&gt; 2   Sph 0.39527463 953.8942</div><div class='input'><span class='fu'>print</span>(<span class='no'>x</span>, <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>3</span>);</div><div class='output co'>#&gt;   model  psill range
#&gt; 1   Nug 0.0611     0
#&gt; 2   Sph 0.3953   954</div><div class='input'><span class='co'># to see all components, do</span>
<span class='fu'>print.data.frame</span>(<span class='no'>x</span>)</div><div class='output co'>#&gt;   model      psill    range kappa ang1 ang2 ang3 anis1 anis2
#&gt; 1   Nug 0.06105141   0.0000   0.0    0    0    0     1     1
#&gt; 2   Sph 0.39527463 953.8942   0.5    0    0    0     1     1</div><div class='input'><span class='no'>vv</span><span class='kw'>=</span><span class='fu'>vgm</span>(<span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>"Tab"</span>,  <span class='kw'>covtable</span> <span class='kw'>=</span>
        <span class='fu'><a href='variogramLine.html'>variogramLine</a></span>(<span class='fu'>vgm</span>(<span class='fl'>1</span>, <span class='st'>"Sph"</span>, <span class='fl'>1</span>), <span class='fl'>1</span>, <span class='kw'>n</span><span class='kw'>=</span><span class='fl'>1e4</span>, <span class='kw'>min</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>covariance</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))
<span class='fu'>vgm</span>(<span class='fu'>c</span>(<span class='st'>"Mat"</span>, <span class='st'>"Sph"</span>))</div><div class='output co'>#&gt; [[1]]
#&gt;   model psill range kappa
#&gt; 1   Nug    NA     0   0.0
#&gt; 2   Mat    NA    NA   0.5
#&gt; 
#&gt; [[2]]
#&gt;   model psill range
#&gt; 1   Nug    NA     0
#&gt; 2   Sph    NA    NA
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "variogramModelList" "list"              </div><div class='input'><span class='fu'>vgm</span>(, <span class='fu'>c</span>(<span class='st'>"Mat"</span>, <span class='st'>"Sph"</span>)) <span class='co'># no nugget</span></div><div class='output co'>#&gt; [[1]]
#&gt;   model psill range kappa
#&gt; 1   Mat    NA    NA   0.5
#&gt; 
#&gt; [[2]]
#&gt;   model psill range
#&gt; 1   Sph    NA    NA
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "variogramModelList" "list"              </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
     Edzer Pebesma 
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Edzer Pebesma, Benedikt Graeler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

